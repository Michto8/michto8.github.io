import{b8 as J,r as C,b9 as z,aq as A,ba as Ne,bb as Te,bc as V,bd as de,be as Ye,aX as qe,bf as He,bg as pe,bh as Ge,bi as je,bj as M,j as e,aS as ve,b4 as Y,s as X,D as Je,bk as se,bl as G,bm as k,aD as K,ad as Le,bn as ye,bo as ze,bp as Xe,bq as Oe,br as Re,bs as Se,bt as Pe,bu as _e,I as ee,O as Ze,bv as Ve,au as Ce,G as j,aC as f,bw as xe,bx as he,by as $e,ak as H,a2 as re,bz as et,C as R,aE as ke,bA as Ae,bB as Ue,aF as De,ae as Be,bC as oe,bD as ie,bE as le,bF as tt,bG as st,bH as ge,bI as nt,bJ as at,bK as rt,as as ot,bL as it,bM as lt,bN as ct,bO as dt,bP as ut,bQ as pt,aT as St,bR as Ct,aI as At,bS as ft,al as mt,w as xt,x as ht,a4 as gt,bT as It,bU as bt,bV as Et,am as Nt}from"./index-2ba9b923.js";import{C as Me,Q as Tt}from"./stepperIcon-58214ebb.js";const jt={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",A100:"#ff9e80",A200:"#ff6e40",A400:"#ff3d00",A700:"#dd2c00"},vt=jt;function ne(t,s){return t[Ne].inventaires[s]}const Lt=t=>{const s=J();return C.useEffect(()=>{s({sessionId:t,type:"INIT_EMPTY_INVENTAIRE"})},[s]),z(o=>A.has(o[Ne].inventaires,t))},yt=t=>{const s=J(),o=z(r=>{const n=ne(r,t);return A.find(n.codeBarre,{indice:n.activeId})}),a=C.useMemo(()=>({setCodeBarre:(r,n={})=>{s({sessionId:t,type:"ADD_SCAN_INVENTAIRE",payload:{indice:Te(),activeStep:V.PANEL_LISTLOTS,depotPreferences:n,listSSCC:[],listLots:[],selectedLot:null,selectedSSCC:null,isLoading:!0,codeBarre:r}})},updateCodeBarre:(r,n)=>{s({sessionId:t,type:"UPDATE_SCAN_INVENTAIRE",indice:r,payload:n})},closeCodeBarre:r=>{s({sessionId:t,type:"CLOSE_SCAN_INVENTAIRE",indice:r,payload:r})}}),[s]);return{codeBarreInfo:o,actions:a}},Ot=t=>{const s=J(),o=z(r=>ne(r,t).currentRaccourci||de()),a=C.useCallback(r=>{s({sessionId:t,type:"SET_RACCOURCI_MOUVEMENTMANUEL",payload:r})},[s]);return{defaultMouvement:o,selectMouvementManuel:a}},Rt=t=>{const s=J(),o=z(n=>ne(n,t).raccourcis),a=C.useCallback((n,i)=>{s({sessionId:t,type:"UPDATE_RACCOURCI_MOUVEMENTMANUEL",payload:{id:n,update:i}})},[s]),r=C.useCallback(n=>{s({sessionId:t,type:"DELETE_RACCOURCI_MOUVEMENTMANUEL",payload:n})},[s]);return{raccourcis:o,onUpdateTypeMouvement:a,onDeleteTypeMouvement:r}},Qe=t=>{const s=z(r=>{const n=ne(r,t);return{codeClient:n.codeClient,libelleClient:n.libelleClient,autoValide:n.autoValide}}),o=J(),a=C.useCallback(r=>{o({sessionId:t,type:"UPDATE_INVENTAIRE",payload:r})},[o]);return{state:s,onUpdateInventaire:a}},Pt=t=>{const{codeBarreInfo:s,actions:o}=yt(t),[a,r]=C.useState("SCAN"),n=Qe(t),{etablissementCode:i}=Ye(),{username:d}=qe(),{getApplicationOptionList:E}=He(),u=E(),{pushMessage:h,errorMessage:S}=pe(),T=o.setCodeBarre,g=C.useCallback((p,b)=>{Ge(i,p,u,b,n.state.codeClient||"").then(({err:y,codeBarre:l})=>{if(y)return S(y);if(n.state.autoValide&&A.size(l==null?void 0:l.LOTS)===1&&A.isNull(p.PoidsScan)===!1){const U=je(l.LOTS[0]);M().TpResserreMethods().valideLotResserre(U)}else T(l,[])})},[i,n.state,S,n.state.autoValide,T]),x=C.useCallback(p=>M().TpResserreMethods().scanEan128({codeBarre:p,depot:i}),[i]),I=()=>{M().TpResserreMethods().valideResserre({codeDepot:i}).then(({err:p,res:b})=>{p?S(p.message):b!=null&&b.Error?S(b==null?void 0:b.MessageError):(h("Réussi","success"),r("SCAN"))})},P=p=>{const b="]C110"+p.INV_LOT_ID;return M().TpResserreMethods().scanEan128({codeBarre:b,depot:i}).then(y=>{const{res:l,err:U}=y;l&&g({...l,liste:A.filter(l.liste,{STO_LOT:p.INV_LOT})},b)})},v=C.useCallback(()=>M().TpResserreMethods().verifLotResserre({codeDepot:i}).then(({err:p,res:b})=>p?{err:p,res:0}:{err:p,res:+b.Result}),[i]);return{properties:u,codeBarreInfo:s,actions:o,etablissementCode:i,username:d,autoValide:n.state.autoValide,onSetAutoValide:p=>n.onUpdateInventaire({autoValide:p}),step:a,onSetStep:r,onFlashSuccess:g,onLectureCodeBarre:x,onSaveInventaire:I,onSelectLot:P,onGetCount:v}},ue=t=>{const{title:s,children:o,className:a,disableAppBar:r,...n}=t;return e.jsx(ve,{i8ntitle:s,withAppBar:!r,isOpen:t.open,className:Y(a,"global-appbar-dialog"),...t,children:o})};X(Je)`
  
  paddingLeft: "4px",
  borderRadius: "5px",
  fontSize: "2.8rem",
  fontWeight: "bold",
  "& .MuiInputBase-root": {
    height: "3rem",
  },
  "& label + .MuiInput-formControl": {
    marginTop: "3px",
  },
  "& .MuiInput-underline": {
    "&:before": {
      //     border:'none'
    },
  },
  "& input:valid + fieldset": {
    borderColor: "green",
    borderWidth: 2,
  },
  "& input:invalid + fieldset": {
    borderColor: "red",
    borderWidth: 2,
  },
  "& input:valid:focus + fieldset": {
    borderLeftWidth: 6,
    padding: "4px !important", // override inline-style
  }
  `;const Vt="data:image/png;base64,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",Ie="QuantiteVL",te={addBtn:`${Ie}-addBtn`,minusBtn:`${Ie}-minusBtn`},kt=X(se)(({theme:t})=>({[`&.${te.addBtn}`]:{backgroundColor:G[500],color:t.palette.getContrastText(k[400]),"&:hover":{background:G[700]}},[`&.${te.minusBtn}`]:{backgroundColor:k[400],color:t.palette.getContrastText(k[400]),"&:hover":{background:k[700]}}}));C.forwardRef((t,s)=>{const{stepper:o=!1,precision:a=0,...r}=t;return e.jsx(K,{ref:s,type:"number",className:"center",InputProps:{startAdornment:e.jsx(Le,{position:"start",children:o?e.jsx(Me,{className:"",active:!0,completed:!!r.value,icon:7}):e.jsx(ye,{children:e.jsx("img",{alt:"quantité",src:Tt})})})},maskProps:{suffix:" ",precision:a},autoComplete:"off",fullWidth:!0,label:"Quantité",resetValue:!0,margin:"dense",...r})});C.forwardRef((t,s)=>{const{stepper:o=!1,precision:a=0,...r}=t;return e.jsx(K,{ref:s,type:"number",className:"center",InputProps:{startAdornment:e.jsx(Le,{position:"start",children:o?e.jsx(Me,{className:"",active:!0,completed:!!r.value,icon:7}):e.jsx(ye,{children:e.jsx("img",{alt:"quantité",src:Vt})})})},maskProps:{suffix:" ",precision:a},autoComplete:"off",fullWidth:!0,label:"Colis",resetValue:!0,margin:"dense",...r})});const Ut=t=>e.jsx(K,{fullWidth:!0,type:"text",disabled:!0,name:"desart",InputLabelProps:{shrink:!0},InputProps:{startAdornment:null},margin:"dense",...t}),we=t=>e.jsx(Fe,{sens:"+",...t}),Dt=t=>e.jsx(Fe,{sens:"-",...t}),Fe=({className:t={},sens:s,...o})=>e.jsx(kt,{disableFocusRipple:!0,className:Y({[te.addBtn]:s==="+",[te.minusBtn]:s==="-",className:t}),size:"large",...o,children:s==="-"?e.jsx(ze,{}):e.jsx(Xe,{})}),Bt=()=>({}),Mt=Bt;function Qt(t){switch(t){case"+":return"quantityAdd";case"-":return"quantityDel";default:return"quantitySum"}}const be=({onSelect:t,menu:s,indice:o,classes:a,onEditMenu:r,onDeleteTypeMouvement:n,...i})=>e.jsxs(Oe,{button:!0,onClick:d=>t(s),children:[e.jsx(Re,{children:e.jsx(Se,{className:Y(a.quantity,a[Qt(s.SENSMVT)]),children:s.SENSMVT})}),e.jsx(Pe,{primary:s.LIBELLE}),e.jsxs(_e,{children:[!!r&&e.jsx(ee,{edge:"end","aria-label":"edition",onClick:d=>r({indice:o,...s}),size:"large",children:e.jsx(Ze,{})}),!!n&&e.jsx(ee,{edge:"end","aria-label":"edition",onClick:d=>n(o),size:"large",children:e.jsx(Ve,{})})]})]});function wt({menu:t,onSave:s,onClose:o}){const[a,r]=C.useState({menu:t}),n=Ce(),i=async()=>{try{const u=await n.showInfiniteSearch({title:"selection",type:"NaturesInventaire",dialogProps:{fullScreen:!0}});if(u!=null){const h={CODENATURE:u.INV_CODE,LIBELLE:u.INV_LIBELLE};r(S=>({...S,menu:{...S.menu,...h}}))}}catch{}},d=u=>{i()},E=u=>{const h={SENSMVT:u.target.value};r(S=>({...S,menu:{...S.menu,...h}}))};return e.jsxs(j,{sx:{m:2,p:2},children:[e.jsxs(f,{container:!0,children:[e.jsx(f,{item:!0,xs:12,sm:"auto",children:e.jsxs(xe,{sx:{m:2,flexDirection:"row"},component:"fieldset",variant:"filled",children:[e.jsx(he,{component:"legend",children:"Sens du mouvement"}),e.jsxs($e,{value:a.menu.SENSMVT,onChange:E,row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"row-radio-buttons-group",children:[e.jsx(H,{value:"=",control:e.jsx(re,{}),label:"="}),e.jsx(H,{value:"+",control:e.jsx(re,{}),label:"+"}),e.jsx(H,{value:"-",control:e.jsx(re,{}),label:"-"})]})]})}),e.jsx(f,{item:!0,xs:12,sm:"auto",children:e.jsxs(xe,{sx:{m:1},component:"fieldset",variant:"standard",children:[e.jsx(he,{component:"legend",children:"Nature d inventaire"}),e.jsx(H,{control:e.jsxs(j,{display:"inline-flex",alignItems:"center",children:[e.jsx(et,{color:"primary",onClick:d}),e.jsx(R,{sx:{pl:2},variant:"subtitle1",gutterBottom:!0,children:a.menu.LIBELLE})]}),label:""})]})})]}),e.jsx(ke,{onClose:()=>o(),onSave:()=>s(a.menu.indice,A.omit(a.menu,"indice"))})]})}const Z="TypeMouvement",W={quantity:`${Z}-quantity`,quantitySum:`${Z}-quantitySum`,quantityAdd:`${Z}-quantityAdd`,quantityDel:`${Z}-quantityDel`},Ft=X("div")(({theme:t})=>({[`& .${W.quantity}`]:{border:"1px solid black"},[`& .${W.quantitySum}`]:{background:"#c0cfd4"},[`& .${W.quantityAdd}`]:{background:G[500]},[`& .${W.quantityDel}`]:{background:k[500]}}));function Wt(t){switch(t){case"+":return"quantityAdd";case"-":return"quantityDel";default:return"quantitySum"}}const Kt=({className:t,onSelect:s,...o})=>{const[a,r]=C.useState(null),n=h=>{r({indice:Te(),...de()})},{raccourcis:i,onUpdateTypeMouvement:d,onDeleteTypeMouvement:E}=Rt(Ae()),u=(h,S)=>{d(h,S),r(null)};return a?e.jsx(wt,{menu:a,onClose:()=>r(null),onSave:u}):e.jsxs(Ft,{children:[e.jsx(we,{style:{position:"absolute",bottom:16,right:16,zIndex:1200},size:"large",onClick:n}),e.jsxs(Ue,{children:[e.jsx(be,{classes:W,indice:0,menu:de(),onEditMenu:null,onDeleteTypeMouvement:null,onSelect:s}),A.map(i,(h,S)=>e.jsx(be,{classes:W,indice:S,menu:h,onEditMenu:r,onDeleteTypeMouvement:E,onSelect:s},S))]})]})};function Yt(t,s,o,a){let r=!1;switch(t.UC){case"C":{if(t.COLISSTOCKPHYSIQUE!==s){r=!0;break}break}case"N":{t.POIDSSTOCKPHYSIQUE!==o&&(r=!0);break}case"P":{t.QUANTITESTOCKPHYSIQUE!==a&&(r=!0);break}}return r}function Ee(t,s){return(t==null?void 0:t.SENSMVT)==="+"||(t==null?void 0:t.SENSMVT)==="-"?{colis:0,piece:0,poids:0}:{colis:s.COLISSAISI,piece:s.QUANTITESAISI,poids:s.POIDSSAISI}}function qt(t){var U,Q,me;const s=Ce(),o=Mt,{defaultMouvement:a,selectMouvementManuel:r}=Ot(Ae());De();const[n,i]=C.useState({mouvement:a,isSaving:!1,comment:"",modalFor:"",...Ee(a,t.lot)}),d=c=>{i(L=>({...L,...c}))},E=c=>{s.showConfirmation({title:"confirmDeleteTitle",message:"confirmDeleteBody",type:"delete",dialogProps:{fullScreen:!1,maxWidth:"sm"}}).then(L=>{L&&(d({isSaving:!0}),t.onDelete(t.lot).then(m=>{t.onSaveComplete({message:"Lot supprimé de l'inventaire."})}))})},u=c=>{x(c.target.name,c.target.value)},h=()=>{x("colis",+n.colis+1)},S=()=>{x("colis",n.colis===0?0:+n.colis-1)};function T(c,L){return!t.properties||!A.has(t,"properties")?L:t.properties[c]}function g(){return T("TPRESSERRE_SAISIE_ECART",!1)}function x(c,L){let m={...n,[c]:L};const w=T("SIT_TP_RECALCUL",!1),q=t.lot.COLISSTOCKPHYSIQUE?t.lot.POIDSSTOCKPHYSIQUE/t.lot.COLISSTOCKPHYSIQUE:1,O=t.lot.COLISSTOCKPHYSIQUE?t.lot.QUANTITESTOCKPHYSIQUE/t.lot.COLISSTOCKPHYSIQUE:1,_=t.lot.POIDSSTOCKPHYSIQUE?t.lot.POIDSSTOCKPHYSIQUE/t.lot.QUANTITESTOCKPHYSIQUE:1,F=(ae,Ke)=>{switch(Ke){case"C":{const B=ge(T("SIT_VE_FORMAT_COLIS",null));return A.round(ae,(B==null?void 0:B.precision)||3)}case"N":{const B=ge(T("SIT_VE_FORMAT_POIDS",null));return A.round(ae,(B==null?void 0:B.precision)||3)}case"P":return A.round(ae,0)}};switch(c){case"colis":{w&&l.UC==="C"&&(m.poids=F(m.colis*q,"N"),m.piece=F(m.colis*O,"P"));break}case"poids":{w&&l.UC==="N"&&(m.colis=F(m.poids/q,"C"),m.piece=F(m.colis*O,"P"));break}case"piece":{w&&l.UC==="P"&&(m.colis=F(m.piece/O,"C"),m.poids=F(m.piece*_,"N"));break}}A.isEmpty(m)||d({...m})}const I=c=>{const L=()=>{var m;return((m=n.mouvement)==null?void 0:m.SENSMVT)!==c.SENSMVT?Ee(c,t.lot):{}};r(c),d({mouvement:c,modalFor:"",...L()})},P=()=>{d({modalFor:""})},v=()=>{d({modalFor:"TYPMVT"})},{errorMessage:p}=pe(),y=()=>{var m,w,q;if(g()&&Yt(t.lot,n.colis,n.poids,n.piece)&&!((m=n.mouvement)!=null&&m.CODENATURE)){p("Nature obligatoire"),d({modalFor:"TYPMVT"});return}d({isSaving:!0});const{lot:c}=t,L=`${c.LIBELLEARTICLE} ${c.NOLOT}/${c.REFLOT}`;t.onSaveQuantite({...c,COLISSAISI:n.colis,QUANTITESAISI:n.piece,POIDSSAISI:n.poids,NATUREINVENTAIRE:((w=n.mouvement)==null?void 0:w.CODENATURE)||"",SENSINVENTAIRE:((q=n.mouvement)==null?void 0:q.SENSMVT)||"="}).then(({res:O,err:_})=>{if(_)throw _;if(O.Error){p(A.get(O,"Message",O.MessageError)),d({isSaving:!1});return}t.onSaveComplete({message:L})}).catch(O=>{d({isSaving:!1}),p(A.get(O,"Message",O.message))})},{lot:l}=t;return n.isSaving?e.jsx(Be,{}):e.jsxs(j,{className:Y(t.className,"main"),sx:o,children:[e.jsx(ue,{open:!!n.modalFor,title:"Nature",onClose:c=>d({modalFor:""}),children:n.modalFor==="TYPMVT"&&e.jsx(Kt,{className:"menus",onSelect:I,onClose:P})}),e.jsx(f,{container:!0,justifyContent:"flex-start",spacing:1,children:e.jsx(f,{item:!0,xs:12,children:e.jsxs(j,{display:"flex",className:Y("blocTypeMvt","border",Wt((U=n.mouvement)==null?void 0:U.SENSMVT)),alignItems:"center",children:[e.jsx(se,{size:"large",className:"iconSens",color:"default",onClick:v,children:(Q=n.mouvement)==null?void 0:Q.SENSMVT}),e.jsx(R,{className:"title",variant:"body1",gutterBottom:!0,children:(me=n.mouvement)==null?void 0:me.LIBELLE})]})})}),e.jsxs(f,{container:!0,justifyContent:"center",spacing:1,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(Ut,{disabled:!0,readOnly:!0,name:"article",label:l.CODEARTICLE||"Article",fullWidth:!0,value:l.LIBELLEARTICLE})}),e.jsx(f,{item:!0,xs:12,md:4,children:e.jsx(K,{type:"text",readOnly:!0,disabled:!0,autoComplete:"off",fullWidth:!0,InputLabelProps:{shrink:!0},label:"Numéro de Lot",resetValue:!0,name:"reflot",value:l.NOLOT})}),e.jsx(f,{item:!0,xs:6,md:4,children:e.jsx(K,{type:"date",readOnly:!0,InputLabelProps:{shrink:!0},disabled:!0,autoComplete:"off",fullWidth:!0,label:"DLC",resetValue:!0,name:"dlc",value:l.DATEDLC})}),e.jsx(f,{item:!0,xs:6,md:4,children:e.jsx(K,{type:"date",readOnly:!0,disabled:!0,InputLabelProps:{shrink:!0},autoComplete:"off",fullWidth:!0,label:"Date Lot",resetValue:!0,name:"dlc",value:l.DATERECEPTION})})]}),e.jsxs(f,{container:!0,justifyContent:"flex-start",spacing:0,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(oe,{isUs:l.UC==="C",enableAddBtn:!0,updateIncrement:c=>{x("colis",ie(c,n.colis))},name:"colis",InputProps:{startAdornment:e.jsx(le,{uvc:"C"})},label:` Stock Physique: ${t.lot.COLISSTOCKPHYSIQUE}`,maskProps:{precision:3},isCompleted:!!n.colis,value:n.colis,onChange:u})}),l.UVCTYPPDS!=="F"&&e.jsx(f,{item:!0,xs:12,children:e.jsx(oe,{isUs:l.UC==="K",enableAddBtn:!0,updateIncrement:c=>{x("poids",ie(c,n.poids))},name:"poids",InputProps:{startAdornment:e.jsx(le,{uvc:"K"})},label:` Stock Physique: ${t.lot.POIDSSTOCKPHYSIQUE}`,maskProps:{precision:3},isCompleted:!!n.poids,value:n.poids,onChange:u})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(oe,{isUs:l.UC==="P",enableAddBtn:!0,updateIncrement:c=>{x("piece",ie(c,n.piece))},name:"piece",InputProps:{startAdornment:e.jsx(le,{uvc:"P"})},label:` Stock Physique: ${t.lot.QUANTITESTOCKPHYSIQUE}`,maskProps:tt(T("formatPoids",null)),isCompleted:!!n.piece,value:n.piece,onChange:u})})]}),e.jsx(f,{container:!0,justifyContent:"flex-start",spacing:1,children:e.jsx(f,{item:!0,xs:7,children:e.jsxs(j,{display:"flex",m:1,justifyContent:"space-around",children:[e.jsx(we,{size:"large",onClick:h}),e.jsx(Dt,{size:"large",onClick:S}),e.jsx(st,{size:"large",onClick:E})]})})}),e.jsx(ke,{onClose:t.onCancel,onSave:y,containerProps:{flexGrow:1,alignItems:"flex-end"}})]})}const Ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGFSURBVEhL7VWrUsQwFF2JROJYB3IlLg2KT0CuRCL5AyRyPwGJRJA2ciUSicTRdocBuZyT3rTbNn0tDIo7c2Y6yb3n3EeSzsba1qqDLFY3eazvP6w6kuXfsexJXaRGv+SJ3hL4/qIYRcVlP2OmWawfPHETFE2tisR9vPl2MNMQcQtT2sZ25Ea/Bon6YHSaGnUtNG1DqXNk8hgMngKjn3OrzoS2svdYH2+S6C4YNAVMMtYnrQOAfr9lRl2ikgW+18HgPqCt7rRh6DL8uVAX5h1JThEnBtEaSQDwwUE4v/1EBzjscr1LwIPtYtsY3NwrgXZsrDrlcDnk3b1BAQcEoZIrkoDM+nVWxgo5TFZci/E+owQEjgRkjhQVjTkQkwQqoF1F1sOz2UsAbUK/l8G9Bv4Fwvs7+HuBvne/xFgB+ll1KNSVYdG9I8EgYkDAX0Ch6zaQtK6+Q48AL14w6y6jc55EqxpRQIC3HL4LCZtuDHZPRVOg+IMtxe3n5t4hPMeFQLQa147Z7Bu/hlgrmdwGhQAAAABJRU5ErkJggg==",Gt=({className:t,onSelectLot:s,list:o})=>e.jsx(Ue,{className:t,children:A.map(o,a=>e.jsx(Jt,{onSelectLot:A.bind(s,null,a),...a},a.IDENR))}),Jt=({onSelectLot:t,UC:s,CODART:o,NOLOT:a,REFLOT:r,DATEDLC:n,QUANTITESTOCKPHYSIQUE:i,CODEARTICLE:d,LIBELLEARTICLE:E,...u})=>e.jsxs(Oe,{button:!0,onClick:h=>t(),children:[e.jsx(Re,{children:e.jsx(Se,{src:Ht})}),e.jsx(Pe,{primary:e.jsxs(C.Fragment,{children:[e.jsx(R,{component:"div",color:"textPrimary",children:d}),e.jsx(R,{component:"div",color:"primary",children:E})]}),disableTypography:!0,secondary:e.jsxs(C.Fragment,{children:[e.jsxs(R,{noWrap:!0,component:"div",variant:"body2",color:"primary",children:["Lot: "+a+" - "+r," ",n?"DLC: "+nt(n):""]}),e.jsx(R,{color:"secondary",component:"div",children:at(i,s)})]})})]}),zt=t=>M().TpResserreMethods().valideLotResserre(je(t)),Xt=t=>M().TpResserreMethods().suppressionLotResserre(rt(t)),_t=(t,s,o)=>{const a=[];switch(s){case V.PANEL_LISTLOTS:{a.push("Sélection du lot");break}case V.PANEL_LISTSSCC:{a.push("Sélection du SSCC");break}case V.PANEL_LISTDEPSTOCK:{a.push("Sélection du dépôt de stock");break}default:a.push(o)}return t&&a.push("Lot "+t.NOLOT+" - "+t.LIBELLEARTICLE),A.join(a,"/ ")},Zt=({className:t="",codeBarreInfo:s,title:o,updateCodeBarre:a,pushMessage:r,errorMessage:n,handleClearCurrentCb:i,properties:d})=>{const E=({message:g,type:x="success"})=>{r(g,x),x==="success"&&i("FICHE")},u=async(g,x)=>{try{if(!g)return;a({isLoading:!0});const I=[],P=I.length===1?I[0]:null;a({isLoading:!1,selectedLot:g,selectedSSCC:P,listSSCC:I,activeStep:V.PANEL_SAISIE})}catch(I){n&&n(typeof I=="string"?I:JSON.stringify(I))}},h=()=>{var x,I,P,v,p;if(!((x=s.codeBarre)!=null&&x.LOTS))return null;if(((I=s.codeBarre)==null?void 0:I.LOTS.length)===1)return(P=s.codeBarre)==null?void 0:P.LOTS[0];const g=A.intersection(A.map((v=s.codeBarre)==null?void 0:v.LOTS,"DEPSTOCK"),S);return g.length===1&&A.find((p=s.codeBarre)==null?void 0:p.LOTS,b=>b.CODEDEPOT===g[0])||null},S=[],T=async(g=null)=>{switch(s.codeBarre.TYPECB){case"CODART":case"EAN13":case"PDSVAR":case"EANPDSVAR":return a({isLoading:!1,activeStep:V.PANEL_LISTDEPSTOCK});default:{const x=h();x?u(x):a({isLoading:!1})}}};return C.useEffect(()=>{T()},[]),e.jsxs(ue,{fullScreen:!0,fullWidth:!0,disableAppBar:!0,title:"",onClose:function(g){console.log("no action")},open:!0,children:[s.isLoading&&e.jsx(Be,{}),s.activeStep===V.PANEL_SAISIE?e.jsx(qt,{className:"resserre panneauSaisie ",lot:s.selectedLot,properties:d,onSaveQuantite:zt,onDelete:Xt,onSaveComplete:E,onCancel:()=>i("FICHE")}):e.jsx(ue,{onClose:g=>i(""),title:_t(s.selectedLot,s.activeStep,o),open:!s.isLoading,children:s.activeStep===V.PANEL_LISTLOTS&&e.jsx(Gt,{className:"",list:s.codeBarre.LOTS,onSelectLot:g=>u(g)})})]})},$t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAABYktHRBXl2PmjAAAAv0lEQVRIS+2VzQqEMAyE06og9aYt0ovv/2qCV8FbtzNrll0RevKw0A9C0mnS+AONSRl5EHv6x3i8gVmWJW3bJvu+U+j7nv44DsbzPHOtOcYYwVdVD5xzEkJgvK4ra8EwDGK99zKOIwUwTRNNY+zDVLP2/dJN09AD1F/zAHRm42kUxLr+1pW7vbs8AP3/f3JtUKQ2KFIbFKkNysQYU9u2GM0k3/c0jbEP67qOWi758SDPhk9evqJPNfHcOvQLiLwAd0Nb3LzbDDcAAAAASUVORK5CYII=";function es(t,s,o){const a=C.useCallback((...r)=>ot().TpResserreMethods().listInventaireUser(s,o,...r),[o,s]);return it({key:"LOTSRESSERRE",fxt:a,query:t})}function ts(t){let s="",o=0,a=0;switch(t.INV_US){case"C":{s="Colis",o=t.INV_STO_COLIS,a=t.INV_COLIS;break}case"P":{s="Pièce",o=t.INV_STO_QUANTITE,a=t.INV_QUANTITE;break}default:s="Poids",o=t.INV_STO_PDS_NET,a=t.INV_PDS_NET;break}return{titre:s,stock:o,inventaire:a}}const ss=({className:t,item:s,onSelect:o,style:a})=>{const r=ts(s);return e.jsx(lt,{style:a,className:t,onClick:n=>o(s),children:e.jsx(ct,{children:e.jsx(dt,{avatar:e.jsx(Se,{className:""}),title:"Lot: "+s.INV_LOT_ID+" - "+s.INV_LOT,subheader:e.jsxs(f,{container:!0,children:[e.jsxs(f,{item:!0,xs:12,children:[e.jsxs("div",{children:[s.ART_CODE," / ",s.ART_LIB1]}),!!s.INV_DATE&&e.jsxs("div",{children:["Inventaire: ",ut(s.INV_DATE)]}),pt(s.INV_US)]}),e.jsxs(f,{item:!0,xs:12,children:[e.jsxs(j,{color:"text.primary",display:"flex",alignItems:"center",children:[r.titre," Stock:",e.jsx(R,{color:"primary",variant:"body1",children:r.stock})]}),e.jsxs(j,{color:"text.primary",display:"flex",alignItems:"center",children:[r.titre," Saisi:",e.jsx(R,{color:"primary",variant:"body1",children:r.inventaire})]})]})]})})})})},ns={},as={ROW_HEIGHT:150};function rs({username:t,codeDepot:s,recherche:o=null,onSelect:a,...r}){const n=es(o,s,t);return e.jsx(St,{labelSearch:"",placeholderSearch:"",ItemComponentProps:ns,onSelect:a,HeaderComponent:null,...r,state:n,ItemMeasureCard:as,ItemComponent:ss})}const ce="ValidationResserre",$={grow:`${ce}-grow`,btn:`${ce}-btn`,btnError:`${ce}-btnError`},os=X(f)(({theme:t})=>({grow:{padding:16,height:"420px",justifyContent:"center",display:"flex",flexDirection:"column",alignItems:"flex-start"},btn:{display:"flex",justifyContent:"flex-start","&:not(:first-child)":{marginTop:16}},btnError:{}})),is=({onSaveInventaire:t,onBack:s,...o})=>{const{t:a}=De();return e.jsx(os,{container:!0,justifyContent:"center",children:e.jsxs(f,{item:!0,xs:10,sm:"auto",className:$.grow,children:[e.jsx(R,{variant:"h6",children:a("validateInventoryTitle")}),e.jsx(Ct,{fullWidth:!0,variant:"outlined",className:$.btn,onClick:t,children:a("validateInventory")}),e.jsx(At,{fullWidth:!0,variant:"outlined",className:$.btn+" "+$.btnError,onClick:s})]})})};function ls({checked:t,onChange:s,label:o}){return e.jsx(ft,{children:e.jsx(H,{control:e.jsx(mt,{checked:t,onChange:s}),label:"Validation automatique"})})}var fe={},cs=ht;Object.defineProperty(fe,"__esModule",{value:!0});var We=fe.default=void 0,ds=cs(xt()),us=e,ps=(0,ds.default)((0,us.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");We=fe.default=ps;function Ss(t){const s=Qe(t.sessionId),o=Ce(),a=async()=>{try{const i=await o.showInfiniteSearch({title:"selection",type:"ClientsMeca",dialogProps:{fullScreen:!0}});i!=null&&s.onUpdateInventaire({codeClient:i.CLI_CODE,libelleClient:i.CLI_NOM})}catch{}},r=()=>{a()},n=()=>{s.onUpdateInventaire({codeClient:"",libelleClient:""})};return e.jsx(j,{padding:1,children:e.jsxs(f,{item:!0,xs:12,className:t.className,children:[e.jsx(j,{m:1,className:"icon",children:e.jsx(se,{size:"large",color:"default",onClick:i=>r(),children:e.jsx(We,{color:"primary"})})}),e.jsx(j,{m:1,className:"title",children:e.jsxs(R,{variant:"h5",gutterBottom:!0,alignItems:"left",children:[s.state.codeClient," ",s.state.libelleClient]})}),e.jsx(j,{m:1,children:e.jsx(ee,{edge:"end","aria-label":"edition",onClick:i=>n(),size:"small",className:"delete",children:e.jsx(Ve,{color:"primary"})})})]})})}const D="ScanCodeBarreResserre",N={containerCodeBarre:`${D}-containerCodeBarre`,container:`${D}-container`,pref:`${D}-pref`,title:`${D}-title`,codeBarre:`${D}-codeBarre`,containerOption:`${D}-containerOption`,options:`${D}-options`,clientMeca:`${D}-clientMeca`},Cs=X(gt)(({theme:t})=>({[`& .${N.containerCodeBarre}`]:{display:"flex"},[`&.${N.container}`]:{"& .orangeAvatar":{margin:10,color:"#fff",backgroundColor:vt[500]},"& .vcbtn":{width:"70px",height:"70px","&.addBtn":{backgroundColor:G[500],color:t.palette.getContrastText(k[400]),"&:hover":{background:G[700]}},"&.minusBtn":{backgroundColor:k[400],color:t.palette.getContrastText(k[400]),"&:hover":{background:k[700]}}},"& .scan":{padding:"1rem","& .title":{paddingLeft:"0.5rem",display:"flex",alignItems:"center"}},"& .sscc":{display:"flex",marginTop:t.spacing(1),padding:t.spacing(1),border:`1px solid ${t.palette.primary.light}`,borderRadius:t.shape.borderRadius,"& .content":{flexGrow:1,marginRight:t.spacing(1)},"& .options":{display:"flex",flexDirection:"column",justifyContent:"space-between","& .option":{minHeight:"56px",background:"rgba(0,0,0,0.2)"}}}},[`& .${N.pref}`]:{marginTop:1,display:"flex",alignItems:"center",paddingBottom:t.spacing(.6),borderBottom:"1px solid #dcdcdc"},[`& .${N.title}`]:{display:"flex",flexDirection:"column",marginLeft:t.spacing(2),[t.breakpoints.up("md")]:{flexDirection:"row"}},[`& .${N.codeBarre}`]:{flexGrow:1,marginTop:t.spacing(1),"&:hover":{background:t.palette.secondary.light,color:t.palette.secondary.contrastText+"!important"}},[`& .${N.containerOption}`]:{margin:t.spacing(2),backgroundColor:"#F8F5F5",display:"flex",flexDirection:"row",justifyContent:"center"},[`& .${N.options}`]:{width:"93%"},[`& .${N.clientMeca}`]:{display:"flex",margin:t.spacing(.5,0),borderRadius:t.shape.borderRadius,boxShadow:t.shadows[4],width:"100%","& .icon":{margin:t.spacing(1,.5)},"& .title":{margin:t.spacing(0,1),width:"90%",fontWeight:800},"& .delete":{background:"#e0e0e0","&:hover":{background:"#fff"}}}})),As=({etablissementCode:t,autoValide:s,username:o,step:a,onSetStep:r,errorMessage:n,pushMessage:i,setCodeBarre:d,properties:E,sessionId:u,onSelectLot:h,onSaveInventaire:S,onLectureCodeBarre:T,onFlashSuccess:g,onSetAutoValide:x,onGetCount:I,...P})=>{const v=C.useRef(null),p=l=>x(l.target.checked);C.useEffect(()=>{a==="SCAN"&&It()&&v&&v.current&&v.current.focus()},[a]);const[b,y]=C.useState(0);return C.useEffect(()=>{let l=null;return a==="SCAN"&&(I().then(({err:U,res:Q})=>{y(Q)}),l=setInterval(()=>{I().then(({err:U,res:Q})=>{U||y(Q)})},2e3)),()=>{l&&clearInterval(l)}},[y,a,I]),e.jsxs(Cs,{className:Y("carreau resserre",N.container),children:[e.jsx(ve,{dialogProps:{fullWidth:!0,maxWidth:"lg",fullScreen:!0},withAppBar:!0,isOpen:a==="LIST",className:"",onCloseDialog:()=>r("SCAN"),i8ntitle:"lots",children:e.jsx(rs,{username:o,codeDepot:t,onSelect:h})}),a==="VALIDE"&&e.jsx(is,{onBack:l=>r("SCAN"),onSaveInventaire:S}),a==="SCAN"&&e.jsxs("div",{className:"scan",children:[e.jsx("div",{className:N.pref,children:e.jsx(se,{disabled:!A.get(E,"VALID_RESSERRE",!1),onClick:l=>r("VALIDE"),color:"secondary",children:e.jsx(bt,{})})}),E.REFERENCE_CLIENT===239&&e.jsx(Ss,{sessionId:u,className:N.clientMeca}),e.jsxs(j,{display:"flex",className:N.containerCodeBarre,children:[e.jsx(Et,{className:N.codeBarre,lecture:T,ref:v,disabled:!1,onError:n,onScanSuccess:g,disabledPadding:!0,placeholder:"Lot",rootClassName:"",disableRemote:!1}),e.jsx(ee,{onClick:l=>r("LIST"),size:"large",children:e.jsx(Nt,{badgeContent:b,color:"secondary",children:e.jsx("img",{alt:"CodeBarre",src:$t})})})]}),e.jsx(ls,{label:s?"AUTO":"MANUEL",checked:s,onChange:p})]})]})},fs=({sessionId:t})=>{const{codeBarreInfo:s,actions:o,etablissementCode:a,username:r,properties:n,autoValide:i,...d}=Pt(t),{pushMessage:E,errorMessage:u}=pe(),h=C.useCallback(S=>{typeof S=="string"&&S==="FICHE"&&A.get(s==null?void 0:s.codeBarre,"TYPECB","")==="CODART"?o.updateCodeBarre(s.indice,{activeStep:V.PANEL_LISTLOTS}):o.closeCodeBarre(s.indice)},[s,o]);return e.jsxs(e.Fragment,{children:[!s&&e.jsx(As,{sessionId:t,etablissementCode:a,autoValide:i,username:r,properties:n,pushMessage:E,errorMessage:u,setCodeBarre:o.setCodeBarre,...d}),s&&e.jsx(Zt,{title:"",className:"",errorMessage:u,properties:n,handleClearCurrentCb:h,pushMessage:E,codeBarreInfo:s,updateCodeBarre:A.bind(o.updateCodeBarre,null,s.indice)})]})};function ms(t){return s=>{const o=Ae();return Lt(o)?e.jsx(t,{...s,sessionId:o}):null}}const gs=ms(fs);export{gs as default};

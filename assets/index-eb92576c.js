import{be as A,gG as v,j as n,gH as B,gI as N,gJ as I,s as g,gK as L,F as T,g8 as _,dP as R,gL as w,G as k,aq as l,gf as D,aF as U,r as m,e6 as d,aQ as x,g7 as q,bs as F,cN as H,a7 as $,gM as z,gN as G,gO as V,ae as h,gP as X,c6 as K,as as Q,gQ as Y,gR as J,gS as W,d4 as Z,gT as ee}from"./index-2ba9b923.js";import{A as P}from"./AppMain-106513ab.js";const b=({className:e,fabProps:s})=>{const{etablissementCode:t,etablissementLib:a}=A(),i=v(),u=c=>i(N(c.DEP_CODE,c.DEP_LIBELLE));return n.jsx(B,{className:e,fabProps:s,etablissementLib:a,etablissementCode:t,onSelectEtablissement:u})},se=()=>{let[e,s]=I();return e.has("autoSelect")},f="MenusModulesAvecDepotStock",p={paper:`${f}-paper`,switch:`${f}-switch`};g(L)(({theme:e})=>({[`& .${p.paper}`]:{padding:0,margin:0},[`& .${p.switch}`]:{padding:"0.8rem 1rem",paddingBottom:8,width:"100%",display:"inline-flex",alignItems:"center",borderBottom:"1px solid #DCDCDC",cursor:"pointer","&:hover":{transition:"background .4s ease-out",background:e.palette.secondary.main,color:e.palette.secondary.contrastText,zIndex:3},"& .fab":{marginRight:"1rem"}}}));const E=e=>{var s,t;return e==="C"?R:(t=(s=w[e])==null?void 0:s.primary)==null?void 0:t.main},ne=g(T,{shouldForwardProp:e=>e!=="category"})(({theme:e,category:s})=>({...e.typography.h5,background:e.palette.background.paper,padding:e.spacing(4,1),boxShadow:e.shadows[2],display:"flex",color:e.palette.text.secondary,alignItems:"center",justifyContent:"flex-start",borderLeft:`1rem solid ${E(s)||e.palette.info.main}`})),te=g(_)(({theme:e,value:s})=>({padding:e.spacing(1),"&.Mui-selected":{background:e.palette.action.selected},"& > .MuiAvatar-root":{background:E(s)||e.palette.secondary.main,color:"#fff"},"& > span.MuiBottomNavigationAction-label":{...e.typography.h5,textTransform:"uppercase"}})),ae=({options:e,onLaunchOption:s,onChangePosition:t})=>n.jsx(k,{sx:{display:"grid",gridTemplateColumns:"repeat( auto-fit, minmax(300px, 1fr) )",alignItems:"flex-start",gap:1,padding:1,overflow:"auto"},children:l.map(e,a=>{const i=D(a.category);return n.jsxs(ne,{color:"inherit",onClick:u=>{s(a)},category:a.category,children:[i&&i,a.title]},a.id)})}),oe=({position:e,listPositions:s,onChangePosition:t,children:a})=>{const{t:i}=U();function u(r){return l.includes(s,r)}const c=m.useMemo(()=>{const r={[d.ACHAT]:"achat",[d.VENTE]:"vente",[d.PREPARATION]:"preparation",[d.STOCK]:"stock",[d.PRODUCTION]:"production"};return x.map(l.filter(s,o=>u(o)),o=>({value:o,label:r[o]}))},[s]);return n.jsx(n.Fragment,{children:n.jsxs(q,{color:"default",value:e,showLabels:!0,onChange:(r,o)=>{t(o)},children:[x.map(c,r=>n.jsx(te,{value:r.value,classes:{root:r.value,selected:"iconSelected"},label:i(r.label),icon:n.jsx(F,{variant:"rounded",children:r.value})},r.value)),a]})})},S=({onLaunchOption:e,options:s})=>{const[t,a]=H("menuPosition",null,!1,"SCALAR"),i=o=>{a(t===o?null:o)},u=(o,y)=>{const C=z(s,l.findIndex(s,{id:o}),l.findIndex(s,{id:y}));G(l.map(C,O=>O.id))},c=l.map(t?l.filter(s,o=>o.category===t):s,o=>({...o,disabled:!1})),r=l.uniq(l.map(s,o=>o.category));return n.jsxs($,{flex:1,className:"menuV2",children:[n.jsx(oe,{listPositions:r,position:t||"",onChangePosition:i}),n.jsx(ae,{options:c,onLaunchOption:e,onChangePosition:u})]})},j={useErrorBoundary:!0,suspense:!1,cacheTime:5e3,staleTime:5e3},M=({autoSelect:e,codePersonnel:s,onLaunchOption:t})=>{const a=V(s,j);return m.useEffect(()=>{const i=a.menus||[];!a.isLoading&&e&&i.length===1&&t(i[0])},[a.isLoading]),a.isLoading?n.jsx(h,{}):n.jsx(S,{options:a.menus||[],onLaunchOption:t})},re=({onLaunchOption:e,autoSelect:s})=>{const t=X(j);return m.useEffect(()=>{const a=t.menus||[];!t.isLoading&&s&&a.length===1&&e(a[0])},[t.isLoading]),t.isLoading?n.jsx(h,{}):n.jsx(S,{options:t.menus||[],onLaunchOption:e})},ie=async()=>await K(Q().CommunMethods().recuperePersonnelUnique({})),le=({codePersonnel:e,onLaunchOption:s,autoSelect:t})=>n.jsxs(P,{disableBackground:!0,children:[n.jsx(b,{className:p.switch,fabProps:{className:"fab"}}),n.jsx(M,{autoSelect:t,codePersonnel:e,onLaunchOption:s})]}),ce=e=>{const{personnelUnique:s,codePersonnelUnique:t}=Y(),{actions:a}=J(),i=W(),{getApplicationOption:u}=Z(),c=u("BORNE_CHOIX_PERSONNEL_TYPE")||null,r=se();return n.jsx(n.Fragment,{children:n.jsxs(P,{disableBackground:!0,children:[s&&n.jsxs(n.Fragment,{children:[n.jsx(b,{className:p.switch,fabProps:{className:"fab"}}),n.jsx(M,{autoSelect:r,codePersonnel:s.PERS_CODE,onLaunchOption:o=>{a.onSelectPersonnel(s,o)}})]}),!t&&!!c&&n.jsx(re,{autoSelect:r,onLaunchOption:i}),!t&&!c&&n.jsx(ee,{onSelect:o=>a.onSelectPersonnel(o,null,r?"?autoSelect=true":null)})]})})},pe=Object.freeze(Object.defineProperty({__proto__:null,MenuPersonnel:le,default:ce,getInfoPersonnelUnique:ie},Symbol.toStringTag,{value:"Module"}));export{le as M,pe as i,se as u};

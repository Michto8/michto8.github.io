import{c as Pt,j as e,fK as kt,fL as Dt,fM as Ft,fN as N,bb as Bt,fO as K,fP as V,aq as C,b8 as Oe,b9 as W,f2 as Vt,r as m,fQ as wt,eL as Ee,as as y,az as me,au as je,ao as Ut,a$ as Ht,aF as fe,eA as X,fR as Qe,at as ve,fS as Wt,bg as zt,fT as Kt,c0 as Ne,e1 as Qt,aQ as oe,fU as qt,fV as qe,f4 as Gt,d4 as nt,fW as $t,fX as Zt,fY as Jt,e6 as Yt,C as b,dR as Ce,dS as Xt,G as v,F as B,dT as en,dU as tn,dV as st,cc as ue,dW as nn,fs as sn,cj as rt,ck as de,fZ as rn,f_ as Se,f$ as an,b4 as Q,cD as Ge,cv as it,cE as at,g0 as on,bP as q,ej as he,aT as Te,c5 as ot,c6 as lt,w as ct,x as ut,g1 as dt,ey as ln,g2 as cn,cr as ft,f7 as ye,eH as ht,E as Ie,cH as pt,cw as un,eP as dn,el as Re,g3 as fn,ae as Me,ct as Ae,cy as gt,bR as hn,a6 as pn,aj as $e,a8 as gn,aE as xt,b7 as Ze,aS as Pe,aC as F,a7 as be,ec as xn,ax as le,aw as mn,g4 as Cn,dx as Sn,cN as Tn,eq as _n,bD as In,am as Ln,g5 as vn,g6 as An,cY as Je,ff as bn,a4 as On,g7 as En,g8 as Ye,O as jn,s as Nn,dd as yn,de as mt,df as Rn,dg as Xe,aH as Mn,d5 as Pn,d6 as kn}from"./index-2ba9b923.js";import{u as Dn,a as Fn,F as Bn,P as Vn}from"./FidegeAccueil-319b8bfb.js";import{j as _e,u as wn}from"./hooks-0ab2d73a.js";import{Z as Un,c as Hn,C as J,d as Wn,e as Le,b as zn}from"./index-8ca0a290.js";import{L as Ct}from"./lneContainerFidege-213a2d35.js";import{B as E}from"./BoxDisplayUVC-b7e42416.js";import{u as Kn}from"./useCallBackState-404d14f4.js";import{A as Qn}from"./AppMain-106513ab.js";import"./actions-d163bdb2.js";const qn=Pt(e.jsx("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"}),"List");function Gn(n,t,r){return{lotStock:null,codeBorne:t,sessionId:n,plateauState:!0,uid:Bt(),articleStock:null,step:K.HOME,zoneTravailPersonnelCode:(r==null?void 0:r.ZONE_CODE)||null,zoneTravailPersonnelLibelle:(r==null?void 0:r.ZONE_LIB)||null}}function $n(n,t){return async(r,i,s)=>{var h;const l=i(),{codePersonnel:a}=kt(l,n),o=Dt(l,n,t);if(a&&o){const d=await Ft(a,t,o,s.getQueryClient(),s.remoteApi());r(N.INVENTAIRE_NEW(Gn(n,t,((h=d.res)==null?void 0:h.zoneTravail)||null)))}else throw new Error("ERR_INVALID_REDUX_STATE")}}function Zn(n,t,r){var s;const i=n[V];return((s=C.find(i.inventaires,l=>l.sessionId===t&&l.codeBorne===r))==null?void 0:s.uid)||null}function Jn(n,t){return{zoneTravail:n[V].inventaires[t].zoneTravailPersonnelCode}}function Yn(n,t){const r=Oe(),i=W(l=>Zn(l,n,t)),s=Vt();return m.useEffect(()=>{i===null&&r($n(n,t)).catch(s.showBoundary)},[i]),i}const Xn="INVFIDEGE",St="INVFIDEGELOT",ee=["INVFIDEGEART"],Tt=["InfoArticleInventaireFidege"],_t=["InfoLotInventaireFidege"],es=(n,t,r,i,s,l,a,o)=>wt(n,{key:ee,keyConfigFilters:"FidegeInventaireArticles",fxt:(d,f)=>y().InventaireFidegeMethods().RechercheArticles({variables:{recherche:d,filtresOptionnels:s,context:(f==null?void 0:f.current)||null}}),query:s,options:{queryOptions:{enabled:o}},onSetQuickFilterValueParam:l,onOpenScanInputText:a,keepScrollPosition:!0},t,r,i);function It(n){return n?(n.LOT_PICKING?"Picking: "+n.LOT_PICKING+". ":"")+(n.ACH_TRACABILITE||""):null}const ts=(n,t,r,i,s,l)=>Ee(n,{key:[St,r,i],keyConfigFilters:"FidegeInventaireLotsArticles",transform:[a=>({itemKey:a.STO_LOT,addFooter:!!a.LOT_PICKING||!!a.ACH_TRACABILITE,commentaire:It(a),type:"TRACA"})],fxt:(a,o)=>y().InventaireFidegeMethods().RechercheLots({variables:{recherche:a,filtresOptionnels:r?me("ART_CODE",r,"="):null,context:(o==null?void 0:o.current)||null,triNolot:i}}),query:null,options:{queryOptions:{enabled:l}},onSetQuickFilterValueParam:t}),ns=(n,t,r)=>Ee(n,{key:[Xn,t],keyConfigFilters:"FidegeTransactionsSoucheArticles",fxt:(s,l)=>{var a;return y().InventaireFidegeMethods().RechercheTransactionSouche({variables:{codart:((a=t.article)==null?void 0:a.ART_CODE)||"",nolot:t.nolot||0,recherche:s,filtresOptionnels:null,context:(l==null?void 0:l.current)||null}})},query:null,options:{queryOptions:{enabled:r}}});function ss(n,t,r,i){return Ee(n,{key:["FidegeInventaireLotsRemplacement",t],fxt:(l,a)=>y().InventaireFidegeMethods().RechercheLotsFidegeInventaire({variables:{recherche:l,filtresOptionnels:t,context:a.current,triNolot:null}}),options:r,query:t,selectorConfig:i})}const Lt=n=>{const t=Ht(),{t:r}=fe(),i=_e(),s=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().ModifiePickingArticle({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r("errorMessage"))}}),l=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().ModifiePickingLot({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r("errorMessage"))}}),a=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().ModifieLotActif({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r("errorMessage"))}}),o=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().ModifieLotDlc({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r("errorMessage"))}}),h=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().ModifieLotQuantite({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r("errorMessage"))}}),d=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().ModifieTransactions({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g,S;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r(((S=c==null?void 0:c.res)==null?void 0:S.codeResult)||"errorMessage"))}}),f=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().EditionInventaire({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r("errorMessage"))}}),u=X({mutationFn:c=>(t.showModalWaitLock(),y().InventaireFidegeMethods().DesoldeLotInventaire({variables:{context:n.current,mutation:c}})),onSettled(c,x,T,p){var g;t.closeModalWaitLock(),(x||((g=c==null?void 0:c.res)==null?void 0:g.codeResult)!="OK")&&i(r("errorMessage"))}});return{ModifiePickingArticle:s,ModifieLotQuantite:h,ModifieListTransaction:d,ModifieLotActif:a,ModifieLotDlc:o,EditionInventaireFidege:f,DesoldeLotInventaire:u,ModifiePickingLot:l}},pe=n=>{const t=Lt(n),r=je(),i=()=>r.showInfiniteSearch({type:"Picking",title:"picking",razValue:!0,dialogProps:{fullWidth:!1,fullScreen:!1,maxWidth:"md"}}),s=m.useCallback((a,o)=>{(async()=>{const d=await i();d&&t.ModifiePickingArticle.mutate({codArt:a,codPicking:d.PICK_CODE||""},{onSettled(f,u,c,x){var T;o(c,((T=f==null?void 0:f.res)==null?void 0:T.codeResult)==="OK")}})})()},[]),l=m.useCallback((a,o)=>{(async()=>{const d=await i();d&&t.ModifiePickingLot.mutate({nolot:a,codPicking:d.PICK_CODE||""},{onSettled(f,u,c,x){var T;o(c,((T=f==null?void 0:f.res)==null?void 0:T.codeResult)==="OK")}})})()},[]);return{handleOpenPicking:s,handleOpenPickingLot:l,mutations:t}},ke=()=>{const n=Ut();return{updateInfoStock:(l,a)=>{n.setQueriesData([_t,{nolot:l}],Qe(a))},updateInfoListLot:(l,a,o)=>{n.setQueriesData([St,l],ve(h=>h.STO_LOT===a,o))},updateInfoArt:(l,a)=>{n.invalidateQueries({queryKey:[ee],exact:!1}),n.setQueriesData([Tt,l],Qe(a))},updateInfoListArt:(l,a)=>{n.setQueriesData(ee,ve(o=>o.ART_CODE===l,a))}}},rs=(n,t,r,i)=>{const s=je(),{t:l}=fe(),a=_e(),o=Oe(),h=pe(t),d=m.useCallback(async(p,g)=>{if(r(),p.codeResult!=="OK"){a({key:"ERR_SCAN_INVALID",options:{batchNumber:p.codeResult+":"+g}});return}const S=p.result;if(S.codeArticle)if(S.numeroLot&&S.lotSolde)if(await s.showConfirmation({title:"confirmTitle",i8nmessage:{key:"confirmBatchUnsold",options:{batchNumber:S.numeroLot}},type:"confirm",dialogProps:{fullScreen:!1,maxWidth:"sm"}}))h.mutations.DesoldeLotInventaire.mutate({numeroLot:S.numeroLot},{onSettled(I,A,_,k){var R;((R=I==null?void 0:I.res)==null?void 0:R.codeResult)==="OK"&&o(N.INVENTAIRE_SELECT_ARTICLE({indice:n,articleStock:S.codeArticle,articleStockLib:"",lotStock:S.numeroLot||null}))}});else return;else o(N.INVENTAIRE_SELECT_ARTICLE({indice:n,articleStock:S.codeArticle,articleStockLib:"",lotStock:S.numeroLot||null}));else S.typeCodeBarre==="EAN13"?(i(me("CRIT_GENCOD",S.ean,"=")),o(N.INVENTAIRE_UPDATE({indice:n,update:{step:K.LIST}}))):a({key:"invalidBarcode"})},[n]),f=m.useCallback(async()=>{const p=await s.showInputScan({title:"barCode",beforeValidateAsync:async(g,S)=>{try{const L=await u(g);if(L&&L.res&&L.res.codeResult==="OK")S(L.res);else try{return s.showError({i8nmessage:{key:"ERR_SCAN_INVALID",options:{batchNumber:"(M)"+g}},i8ntitle:l("error"),dialogProps:{maxWidth:"md",fullWidth:!0}}),!1}catch{}}catch{}return!0},dialogProps:{maxWidth:"md",fullWidth:!0},props:{type:"text",value:""}});p&&d(p,"")},[d]),u=m.useCallback(p=>y().InventaireFidegeMethods().ScanEan128InventaireFidege({variables:{context:t.current,demande:{codeBarre:p}}}),[t]),{parseScan:c}=Dn(),x=m.useCallback(async p=>{var L;const{clearCb:g}=p,S=c(p);if(S)try{g&&g();const I=await u(S.cbValue);return I.res&&d(I.res,S.cbValue),((L=I==null?void 0:I.res)==null?void 0:L.codeResult)==="OK"}catch{}else return p.updateQuery(p.val),!0;return!1},[u]);return{onScanError:a,onScanSuccess:d,onOpenModalSearchOrder:f,onLectureCodeBarre:u,onLectureCodeBarreDepuisListArticle:x,onLectureCodeBarreDepuisArticle:x}};function ce(n,t,r){return Wt(s=>t(s?{indice:n,...s}:{indice:n}),r)}function is(n,t){return async(r,i,s)=>{r(N.STEP_BACK({indice:n}));const l=i()[V],a=l.inventaires[n].articleStock,o=l.inventaires[n].rowPosition;if(a)if(o){const d=(()=>{let f=[];try{const u=s.getQueryClient().getQueriesData({queryKey:ee,exact:!1}),c=oe.last(u);if(c){const[x,T]=c;return oe.each(T.pages,(p,g)=>{(qe(p,o.visibleStartIndex??0)||qe(p,o.visibleStopIndex??0))&&f.push(g)}),f}return[]}catch{return[]}})();if(oe.isEmpty(d))y().InventaireFidegeMethods().RechercheArticles({variables:{context:t,recherche:{rbp:1,qbRules:me("STO_CODART",a,"=")}}}).then(f=>{var u;(u=f.res)!=null&&u.result[0]&&s.getQueryClient().setQueriesData(ee,ve(c=>c.ART_CODE===a,f.res.result[0]))});else try{s.getQueryClient().refetchQueries({exact:!1,queryKey:ee,refetchPage(f,u,c){return oe.includes(d,u)}}).then(f=>{s.getQueryClient().setQueriesData(ee,qt((u,c)=>!oe.includes(d,c)))})}catch{}}else s.getQueryClient().removeQueries({exact:!1,queryKey:ee})}}const as=(n,t,r,i,s)=>{const l=zt(),a=Oe(),o=_e();return m.useMemo(()=>({scan:s,showError:o,onChangeZoneTravail:d=>{a(N.setZoneTravail({indice:n,zoneTravail:d}))},onClearLotSelected:ce(n,N.INVENTAIRE_ClearLot,a),onOpenPrint:ce(n,N.INVENTAIRE_OpenPrint,a),onOpenSouche:ce(n,N.INVENTAIRE_OpenSouche,a),onSelectNatureInventaire:ce(n,N.INVENTAIRE_SELECT_NATURE,a),onSelectArticle:d=>{var f,u,c,x;a(N.INVENTAIRE_SELECT_ARTICLE({indice:n,articleStock:d.ART_CODE,articleStockLib:d.ART_LIB1||"",rowPosition:{visibleStartIndex:((u=(f=i.rowPosition)==null?void 0:f.get())==null?void 0:u.visibleStartIndex)??null,visibleStopIndex:((x=(c=i.rowPosition)==null?void 0:c.get())==null?void 0:x.visibleStopIndex)??null}}))},onSelectLot:ce(n,N.INVENTAIRE_SELECT_LOT,a),messages:l,onChangePersonnel:d=>{d&&a(Kt(t,d))},onChangeBottomState:d=>{a(N.INVENTAIRE_UPDATE({indice:n,update:{bottomState:d}}))},onNavigateList:async()=>{var d;i.data.removeQuery(),i.data.resetPreviousData(),i.actions.onClearQuickSearchValue(),(d=i.rowPosition)==null||d.reset(),a(N.INVENTAIRE_UPDATE({indice:n,update:{step:K.LIST}}))},onChangeStep:d=>a(N.INVENTAIRE_UPDATE({indice:n,update:{step:d}})),onStepBack:()=>{a(is(n,r))},onCloseModal:()=>a(N.INVENTAIRE_CLOSE_MODAL({indice:n})),updateStepPreparation:d=>a(N.UPDATE_STEP({indice:n,step:d}))}),[n,i.data.resetPreviousData])},De=n=>{const t=W(r=>Jn(r,n),Ne);return Qt(t)};function os(n){return W(t=>{const r=t[V].inventaires[n];return{articleStock:r.articleStock,articleLibelle:r.articleLibelle}},Ne)}function ls(n){return W(t=>t[V].inventaires[n].articleStock)}function cs(n){return W(t=>t[V].inventaires[n].lotStock)}function us(n){return W(t=>t[V].inventaires[n].lotStockScan?t[V].inventaires[n].lotStock:null)}function ds(n){return W(t=>t[V].inventaires[n].bottomState??0)}function vt(n){return W(t=>t[V].inventaires[n].modalFor)}function fs(n){return W(t=>t[V].inventaires[n].natureInventaire||null)}function hs(n){const t=De(n),r=W(x=>C.pick(x[V].inventaires[n],["step","modalFor","sessionId","zoneTravailPersonnelCode","zoneTravailPersonnelLibelle","articleStock"]),Ne),{codePersonnel:i,nomPersonnel:s}=Gt((r==null?void 0:r.sessionId)||""),l=nt(),a=$t("FidegeInventaireArticles",null),o=Zt("FidegeInventaireArticles",null,a.sortOptions||null),h=m.useMemo(()=>[{field:"CRIT_DLC",value:+(l.getParametreBorneValue("V2_CRIT_DLC")||0)},{field:"CRIT_NB_JOURS_CONTROL",value:+(l.getParametreBorneValue("V2_CRIT_JOURS")||0)}],[]),d=Jt(o,a,null,h),f=rs(n,t,()=>{d.updateQuery({type:"CLEAR_QUICKR"})},d.updateQuickRulesValue),u=es(t,o,d,a,null,f.onLectureCodeBarreDepuisListArticle,f.onOpenModalSearchOrder,(r==null?void 0:r.step)!==K.HOME),c=as(n,r==null?void 0:r.sessionId,t.current,u,f);return{contextGlobal:t,codePersonnel:i,nomPersonnel:s,operation:r,actions:c,data:u,disableSwitchPersonnel:l.getParametreBorneZone1("V2_LOCKPERS")}}function ps(n){return W(t=>t[V].inventaires[n].souche||null)}const gs=({operationId:n})=>{const t=os(n);return e.jsxs(b,{variant:"inherit",children:[" ",t.articleStock," "]})};function xs(n){return n===K.HOME?"Recherche":n===K.LIST?"Articles":null}const ms=({operationId:n,onChangeStep:t,onStepBack:r,step:i})=>e.jsx(Fn,{title:xs(i)||e.jsx(gs,{operationId:n}),typeMod:Yt.STOCK,isHome:i===K.HOME,onStepBack:r});function Cs({className:n,disableSwitchPersonnel:t,contextGlobal:r,codePersonnel:i,nomPersonnel:s,zoneTravailPersonnelCode:l,zoneTravailPersonnelLibelle:a,data:o,onNavigateList:h,onChangePersonnel:d,onChangeZoneTravail:f,onScanSuccess:u,onScanError:c,onOpenModalSearchOrder:x,onLectureCodeBarre:T}){const p=Ce(),g=m.useRef(null),S=nt();return e.jsxs(Bn,{className:n,children:[e.jsx(Vn,{className:"personnel",onChange:d,disabled:t,typeBorne:r.current.typeBorne,title:s,code:i,lookupProps:{disabledClear:!0}}),S.getApplicationOption("SPE_ZONE_TRAVAIL")&&e.jsx(Un,{className:"zoneTravail",onChange:f,title:a,code:l}),o.visualState.query&&e.jsx(Xt,{ref:g,className:"filtresQuick",readOnly:!0,fields:o.Recherches.fields,query:o.visualState.query,onQueryChange:o.actions.onUpdateQuery}),e.jsx(v,{display:"flex",alignItems:"stretch",flexDirection:"column",className:"scanContainer",children:e.jsxs(v,{display:"flex",alignItems:"center",gap:.5,className:"navigate-actions",children:[e.jsx(B,{className:"grid-actions kb-scan",color:"info",variant:"contained",size:"large",onClick:L=>x(),children:e.jsx(en,{color:"inherit"})}),e.jsx(tn,{size:"kingSize",virtualKeyboard:[],className:"scanInput",placeholder:"Numero de lot",autoFocus:!0,ref:p,disabled:!1,onError:c,onScanSuccess:u,lecture:T,rootClassName:"",disableRemote:!1,showClearButton:!0,disabledPadding:!0})]})}),e.jsxs(v,{className:"navigate",flexGrow:1,alignItems:"stretch",justifyContent:"space-between",children:[e.jsx(B,{className:"clear",startIcon:e.jsx(st,{}),color:"error",fullWidth:!0,variant:"contained",size:"large",onClick:L=>o.actions.onClearAll(),children:ue("clearFilters")}),e.jsx(B,{className:"nextstep",startIcon:e.jsx(nn,{}),color:"success",fullWidth:!0,variant:"outlined",size:"large",onClick:L=>{h()},children:ue("product")})]})]})}function Ss(){return e.jsx("div",{children:"searchScan"})}const Ts=[{label:"Inv O/N",field:"TRI_DATE"},{label:"PICKING",field:"TRI_PICKING",icon:Se},{label:"ARTICLE",field:"TRI_ARTICLE"},{label:"negatif",field:"TRI_STKNEG",sort:"desc"},{label:"lot0",field:"TRI_LOT_0",sort:"desc"},{label:"DLC mini",field:"TRI_DLC",icon:Hn},{label:"Arrivage",field:"TRI_ARRIVAGE",icon:an}],_s=n=>{const t=(r,i)=>{n.onChangeHaving(i)};return e.jsx(sn,{listTri:Ts,...n,children:e.jsxs(rt,{sx:{maxWidth:320,"& > .MuiButtonBase-root.MuiToggleButton-root":{fontSize:10,m:0,p:0}},value:n.having||["V","J","R"],onChange:t,"aria-label":"text formatting",children:[e.jsx(de,{value:"V","aria-label":"underlined",sx:{"&.Mui-selected":{bgcolor:"success.main",color:"success.contrastText"}},children:"Article scanné et/ou régulé ce jour"}),e.jsx(de,{value:"J","aria-label":"underlined",sx:{"&.Mui-selected":{bgcolor:rn[600],color:"black"}},children:"Article à contrôler"}),e.jsx(de,{value:"R","aria-label":"underlined",sx:{"&.Mui-selected":{bgcolor:"warning.main",color:"warning.contrastText"}},children:"Stock négatif/ventes non affectées"})]})})},Is={COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:120,md:{COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:60}},At={V:"green",O:"orange",J:"jaune"},bt=(n,t=!1)=>n&&At[n.STATUT||"J"]||"jaune";function Ls({children:n,disabled:t,onClick:r}){return e.jsx(B,{color:"secondary",startIcon:e.jsx(Se,{}),sx:{width:"13ch",justifyContent:"flex-start",textAlign:"left"},"aria-label":"Valorize",variant:"contained",onClick:r,size:"large",disabled:t,children:n})}const vs=({className:n,item:t,ItemComponentProps:r,onSelect:i,style:s,...l})=>{var f,u;const a=bt(t),o=a==="jaune"?"red":"yellow",h=m.useCallback(c=>{i(t)},[t]),d=m.useCallback(()=>{r.onChangePicking(t)},[t]);return e.jsx(Ct,{style:s,FirstActionButton:Ls,FirstActionText:t==null?void 0:t.ART_PICKING,onFirstAction:d,noMargin:!0,dividerRight:!0,className:Q(n,"line-article-stock",a),onClick:h,_properties:void 0,children:t&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{gridArea:"art",display:"flex",className:"relative",flexDirection:"column",alignItems:"flex-start",children:[e.jsx(Ge,{typoProps:{overflow:"hidden",className:"w-full",noWrap:!0,color:"inherit",variant:"inherit",fontWeight:600},content:t.ART_LIB1,field:"ART_LIB1",matchSxProps:{color:o},matchSearch:(f=t._properties)==null?void 0:f.matchSearch}),e.jsxs(v,{display:"flex",alignItems:"center",columnGap:.5,children:[e.jsx(it,{fontSize:"small",codeStat:t.ART_STAT_IMAGE}),e.jsx(Ge,{typoProps:{color:"inherit",variant:"inherit",fontWeight:600},content:t.ART_CODE,field:"ART_CODE",matchSxProps:{color:o},matchSearch:(u=t._properties)==null?void 0:u.matchSearch}),!!t.ART_PAYS&&t.ART_PAYS!=="0"&&e.jsx(at,{svg:!0,countryCode:t.ART_PAYS})]}),!!t.NB_LOT_0&&e.jsx(on,{fontSize:"small",sx:{color:"text.disabled",position:"absolute",right:0,top:"50%"}})]}),e.jsx(J,{className:"nblot",bodyAlign:"center",Icon:null,text:String(t.NB_LOT||""),label:t.NB_LOT>1?"Lots":"Lot",gridArea:"nblot"}),e.jsx(J,{className:"dlcMini",text:t.DATE_ACH_DLC&&q(t.DATE_ACH_DLC)||"",label:"Dlc MINI",gridArea:"dlcMini"}),e.jsx(E,{className:"qtephy",iconPosition:"bodyRight",variant:"inherit",fontSize:"medium",label:"Tot.",format:(r==null?void 0:r.format)||null,gridArea:"qtephy",UVC:t.ART_UNIT_STK||"P",value:t.STO_TOT}),e.jsx(E,{className:"qte",iconPosition:"bodyRight",variant:"inherit",fontSize:"medium",label:"Pot.",format:(r==null?void 0:r.format)||null,gridArea:"qte",UVC:t.ART_UNIT_STK||"C",value:t.STO_POT}),e.jsx(J,{className:"arrivage",noBorder:!0,Icon:null,text:C.round(t.J0_COLIS||0,0)+"/"+C.round(t.J1_COLIS||0,0),label:"J/J+1",gridArea:"arrivage"})]})})};function As({context:n,state:t,onSelect:r}){const i=he("STOCK"),s=pe(n),l=ke(),a=m.useCallback(d=>{s.handleOpenPicking(d.ART_CODE,(f,u)=>{u?l.updateInfoListArt(f.codArt,{ART_PICKING:f.codPicking}):t.data.refetch()})},[n]),o=m.useMemo(()=>({useIsScrolling:!1,format:i,onChangePicking:a}),[i]),h=Ce();return e.jsx(Te,{state:t,onSelect:r,ItemMeasureCard:Is,kbManageRef:h,HeaderComponent:_s,ItemComponent:vs,ItemComponentProps:o,labelSearch:"",gridModes:["list"],disableFavorite:!0})}const bs=(n,t,r={})=>ot([Tt,t],()=>lt(y().InventaireFidegeMethods().RecupereInfoArticle({variables:{demande:t,context:n.current}})),r),Ot=(n,t,r={})=>ot([_t,t,n.getQueryKey()],()=>lt(y().InventaireFidegeMethods().RecupereInfoLot({variables:{demande:t,context:n.current}}).then(i=>{var s,l,a,o;if(((s=i.res)==null?void 0:s.codeResult)!="OK"||!((l=i.res)!=null&&l.result)||!((o=(a=i.res)==null?void 0:a.result)!=null&&o.lot))throw new Error("Lot invalide ou inexistant");return i})),r);var Fe={},Os=ut;Object.defineProperty(Fe,"__esModule",{value:!0});var Et=Fe.default=void 0,Es=Os(ct()),js=e,Ns=(0,Es.default)((0,js.jsx)("path",{d:"M6 6h12v12H6z"}),"Stop");Et=Fe.default=Ns;const ys={COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:120,md:{COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:60}},Rs=({disabled:n,onClick:t,...r})=>e.jsx(B,{disabled:n,variant:"contained",onClick:t,...r,children:"BL"});function Ms(n){return n?At[n.STATUT||"J"]:"jaune"}const Ps=({className:n,item:t,ItemComponentProps:r,onSelect:i,style:s,...l})=>{var d,f;const a=he("STOCK"),o=t.ACH_LOT_ACTIF=="N"?Et:null,h=t.STO_LOT===(r==null?void 0:r.lotSelected);return e.jsxs(Ct,{style:s,onValorize:()=>r==null?void 0:r.onOpenLotSouche(t),ValorizeButton:Rs,noMargin:!0,dividerRight:!0,_properties:t._properties,className:Q(n,"line-lot-stock",{lotSelected:h},Ms(t),{selected:h}),onClick:u=>i(t),children:[e.jsx(J,{color:h?"secondary.main":"inherit",label:"",textAlign:"left",hideLabel:!0,variant:"inherit",gridArea:"nolot",matchSearch:(d=t._properties)==null?void 0:d.matchSearch,Icon:null,text:String(t.STO_LOT)}),e.jsx(J,{textAlign:"left",hideLabel:!0,oneLine:!0,matchSearch:(f=t._properties)==null?void 0:f.matchSearch,variant:"inherit",gridArea:"frn",Icon:null,text:t.FOU_NOM||""}),e.jsx(J,{variant:"inherit",gridArea:"dlc",Icon:o,label:"DLC",text:t.ACH_DLC&&q(t.ACH_DLC)||""}),e.jsx(v,{gridArea:"arrivage",display:"flex",flexDirection:"row",sx:{overflowY:"hidden"},children:e.jsxs(b,{variant:"inherit",noWrap:!0,flexShrink:0,children:["arrivage : ",t.ACH_BL," du ",t.ACH_DATE_REC&&q(t.ACH_DATE_REC)]})}),e.jsx(E,{variant:"h5",fontSize:"medium",format:a,UVC:"C",gridArea:"stock1",value:t.TOT_COLIS}),e.jsx(E,{variant:"h5",fontSize:"medium",format:a,UVC:"N",gridArea:"stock2",value:t.TOT_POIDS}),e.jsx(E,{variant:"h5",fontSize:"medium",format:a,UVC:"P",gridArea:"stock3",value:t.TOT_PIECES}),e.jsx(v,{sx:{position:"absolute",right:0,top:0},children:t.LOT_PICKING})]})};function ks({item:n,style:t,onSelect:r,ItemComponentProps:i,className:s}){const l=dt(n.ART_UNIT_STK)||"C",a=ln(l,i.format),o="",h=cn(l,n.TOT_COLIS,n.TOT_POIDS,n.TOT_PIECES);return e.jsxs(ft,{style:t,sx:{display:"grid",gap:.5,px:1,py:0,width:"100%",flexBasis:"100%",alignItems:"center",columnGap:1,gridTemplateColumns:"minmax(max-content,20ch) 1fr 180px 180px",gridTemplateAreas:' "nolot frn stock dlc" ',bgcolor:"#CFBDED",opacity:"1 !important","& > *":{borderRight:1,borderColor:"divider"},...ye},disabled:o==="S",className:Q(s,"jaune"),onClick:d=>{r(n)},children:[e.jsxs(v,{gridArea:"nolot",display:"flex",columnGap:1,alignItems:"center",children:[e.jsx(ht,{}),!(i!=null&&i.SPE_VALO_MASQUER_LOT)&&e.jsx(Ie,{title:"Numéro de lot",children:e.jsx(b,{variant:"inherit",children:n.STO_LOT})})]}),e.jsxs(v,{gridArea:"frn",display:"flex",columnGap:1,alignItems:"center",children:[e.jsx(pt,{}),e.jsx(Ie,{title:"Fournisseur",children:e.jsx(b,{variant:"inherit",children:n.FOU_NOM})})]}),e.jsxs(v,{gridArea:"dlc",display:"flex",columnGap:1,alignItems:"center",children:[e.jsx(Wn,{}),e.jsx(Ie,{title:"DLC",children:e.jsx(b,{variant:"inherit",children:n.ACH_DLC&&q(n.ACH_DLC)})})]}),e.jsx(v,{gridArea:"stock",children:e.jsx(un,{formatQte:!0,formatUC:a,uvc:l,qtePesee:h})})]})}const Ds={COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:120,md:{COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:60}};function Fs({context:n,recherche:t=null,onSelect:r,...i}){const l=ss(n,t,{}),a=wn();return e.jsx(Te,{ItemMeasureCard:Ds,ItemComponentProps:{format:a,SPE_VALO_MASQUER_LOT:!1},onSelect:r,disablePadding:!0,disableGap:!0,disableContainer:!0,ItemComponent:ks,disableFavorite:!0,state:l,labelSearch:"",placeholderSearch:""})}function jt({colis:n,poids:t,pieces:r,UV:i,formats:s,handleChangeByName:l,sx:a,labelColis:o,labelPoids:h,labelPieces:d}){const{t:f}=fe();return e.jsxs(v,{sx:dn({display:"grid",gridTemplateColumns:{xs:"auto",md:"repeat(3,1fr)"},gap:.4,p:.4},a),children:[e.jsx(Le,{uvc:"C",className:Q("UCD",{UV:i==="C"}),maskProps:s.formatColis,allowSS:i!=="C",name:"colis",label:f("uniteC")+" : "+o,valueMax:null,value:n,onChange:l,isCompleted:!0}),e.jsx(Le,{uvc:"N",className:Q("UCD",{UV:i==="N"}),maskProps:s.formatPoids,name:"poids",label:f("uniteN")+" : "+h,allowSS:i!=="N",valueMax:null,value:t,onChange:l,isCompleted:!0}),e.jsx(Le,{uvc:"P",className:Q("UCD",{UV:i==="P"}),maskProps:s.formatPieces,name:"pieces",allowSS:i!=="P",label:f("uniteP")+" : "+d,valueMax:null,value:r,onChange:l,isCompleted:!0})]})}var Be={},Bs=ut;Object.defineProperty(Be,"__esModule",{value:!0});var Nt=Be.default=void 0,Vs=Bs(ct()),ws=e,Us=(0,Vs.default)((0,ws.jsx)("path",{d:"M11 7h6v2h-6zm0 4h6v2h-6zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7zM3 3v18h18V3H3zm16 16H5V5h14v14z"}),"ListAltSharp");Nt=Be.default=Us;function yt(n,t){let r=1,i=(n==null?void 0:n.ART_PIECE_COL)??null,s=(n==null?void 0:n.ART_PDS_NET)??null;return t&&(r=(t==null?void 0:t.ACH_COLIS_REC)??null,i=(t==null?void 0:t.ACH_QUANTITE_REC)??null,s=(t==null?void 0:t.ACH_PDS_NET_REC)??null),{nbPiecesParColis:r?(i??0)/r:null,poidsMoyenColis:r?(s??0)/r:null,poidsMoyenPiece:i?(s??0)/i:null}}function Hs(n,t){var r,i,s;return C.isNull(n.colis)&&C.isNull(n.pieces)&&C.isNull(n.poids)?!1:n.colis!=(((r=t==null?void 0:t.lot)==null?void 0:r.TOT_COLIS)??0)||n.pieces!=(((i=t==null?void 0:t.lot)==null?void 0:i.TOT_PIECES)??0)||n.poids!=(((s=t==null?void 0:t.lot)==null?void 0:s.TOT_POIDS)??0)}const Ws=({context:n,formats:t,article:r,lotStock:i,lot:s,onOpenPrint:l,onSelectNatureInventaire:a,natureInventaire:o,onSaveComplete:h,isFetching:d,isReFetching:f})=>{var ne,se,re,ie,ae,z,Z,xe,Ve,we,Ue,He,We,ze,Ke;const{t:u}=fe(),c=ke(),x=pe(n),T=je(),[p,g]=m.useState({colis:null,poids:null,pieces:null}),S=m.useMemo(()=>yt((r==null?void 0:r.article)||null,s),[r,s==null?void 0:s.ACH_COLIS_REC,s==null?void 0:s.ACH_QUANTITE_REC]),L=f||d||(s==null?void 0:s.ACH_VALOR)==="N",I=m.useCallback(()=>{g({colis:0,poids:0,pieces:0})},[]);m.useEffect(()=>{g({colis:null,poids:null,pieces:null})},[i]);const A=m.useCallback(M=>{try{i&&T.showInfiniteSearch({type:"RegulInventaire",title:"inventoryModification",props:{recherche:me("INV_LOT",i,"=")},dialogProps:{fullWidth:!1,fullScreen:!1,maxWidth:"md"}})}catch{}},[i]),_=m.useCallback((M,O,U=!0)=>{g(H=>Re(H,j=>{const{nbPiecesParColis:P,poidsMoyenColis:w,poidsMoyenPiece:D}=S;j[M]=O,U&&(M==="colis"&&(P&&(j.pieces=C.round((O??0)*P)),w&&(j.poids=C.round((O??0)*w,4))),M==="poids"&&(w&&(j.colis=C.round((O??0)/w,2)),D&&(j.pieces=C.round((O??0)/D,0))),M==="pieces"&&(P&&(j.colis=C.round((O??0)/P,2)),D&&(j.poids=C.round((O??0)*D,4))))}))},[S]),k=dt(((ne=r==null?void 0:r.article)==null?void 0:ne.ART_UNIT_STK)||null),R=m.useCallback((M,O=!0)=>{_(M.target.name,+(M.target.value||0),O)},[_]),Y=m.useCallback(M=>{i&&x.mutations.ModifieLotActif.mutate({nolot:i,actif:M?"O":"N"},{onSuccess(O,U,H){var j,P;((j=O.res)==null?void 0:j.codeResult)==="OK"&&(c.updateInfoStock(i,{ACH_LOT_ACTIF:U.actif}),c.updateInfoListLot((P=r==null?void 0:r.article)==null?void 0:P.ART_CODE,i,{ACH_LOT_ACTIF:U.actif}))}})},[i]),G=m.useCallback(M=>{i&&x.handleOpenPickingLot(i,(O,U)=>{var H;U&&(c.updateInfoStock(i,{LOT_PICKING:O.codPicking}),c.updateInfoListLot((H=r==null?void 0:r.article)==null?void 0:H.ART_CODE,i,j=>{const P=It({...j,LOT_PICKING:O.codPicking});return{LOT_PICKING:O.codPicking,_properties:{...j._properties||{},addFooter:!!P,commentaire:P}}}))})},[i]),$=(se=s==null?void 0:s.lot)!=null&&se.ACH_DLC?q((re=s==null?void 0:s.lot)==null?void 0:re.ACH_DLC):"",te=m.useCallback(async M=>{if(i){const O=await T.showInputDate({i8ntitle:"DLC: "+$,dialogProps:{maxWidth:"md",fullWidth:!0},props:{inputFormat:"dd/MM/yy"}});O!==null&&x.mutations.ModifieLotDlc.mutate({nolot:i,dlc:O.value?fn(O.value):null},{onSuccess(U,H,j){var P,w;((P=U.res)==null?void 0:P.codeResult)==="OK"&&(c.updateInfoStock(i,D=>D.lot?{...D,lot:{...D.lot,ACH_DLC:H.dlc}}:D),c.updateInfoListLot((w=r==null?void 0:r.article)==null?void 0:w.ART_CODE,i,{ACH_DLC:H.dlc}))}})}},[i,$]),ge=M=>{var U,H,j;if(!i||d||f||!r||!r.article||(s==null?void 0:s.ACH_VALOR)==="N")return;(async P=>{let w="";if(Hs(p,s)){if(!w){const D=await T.showInfiniteSearch({type:"NaturesInventaire",title:"nature",dialogProps:{fullWidth:!1,fullScreen:!1,maxWidth:"md"}});if(D==null)return;a({natureInventaire:D}),w=D.INV_CODE}if(!w)return}x.mutations.ModifieLotQuantite.mutate({...P,natureInventaire:w||""},{onSuccess(D,ir,ar){h()}})})({codArt:r.article.ART_CODE,nolot:i,colis:p.colis??((U=s==null?void 0:s.lot)==null?void 0:U.TOT_COLIS)??0,poids:p.poids??((H=s==null?void 0:s.lot)==null?void 0:H.TOT_POIDS)??0,pieces:p.pieces??((j=s==null?void 0:s.lot)==null?void 0:j.TOT_PIECES)??0,depot:(s==null?void 0:s.STO_DEPOT)||null,site:null,natureInventaire:""})};return e.jsxs(v,{className:"infoLot",children:[e.jsxs(v,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[d&&e.jsx(Me,{color:"secondary",sx:{width:"120px",height:"8px"}}),!i&&e.jsx(b,{variant:"inherit",color:"text.disabled",children:"aucun lot sélectionné"})]}),e.jsxs(v,{className:Q("header-container",{disabled:!s}),children:[e.jsxs(v,{className:"border",alignItems:"center",gridArea:"lot",display:"inline-flex",gap:.5,children:[e.jsx(ht,{fontSize:"inherit",color:"disabled"}),e.jsx(b,{variant:"inherit",color:"secondary",children:i}),e.jsxs(b,{variant:"inherit",color:"inherit",children:["du ",((ie=s==null?void 0:s.lot)==null?void 0:ie.ACH_DATE_REC)&&q((ae=s==null?void 0:s.lot)==null?void 0:ae.ACH_DATE_REC)," n° ",(z=s==null?void 0:s.lot)==null?void 0:z.ACH_BL]})]}),e.jsxs(b,{component:v,sx:{gap:.5,display:"flex",alignItems:"center"},className:"border",gridArea:"frn",variant:"inherit",children:[e.jsx(pt,{fontSize:"inherit",color:"disabled"}),(Z=s==null?void 0:s.lot)==null?void 0:Z.FOU_NOM]}),e.jsxs(b,{component:v,sx:{gap:.5,display:"flex",alignItems:"center"},className:"border",gridArea:"dlc",variant:"inherit",children:[e.jsx(Ae,{fontSize:"inherit",color:"disabled"}),e.jsx("span",{children:"DLC: "})," ",$]}),e.jsx(jt,{sx:{gridArea:"qtys"},colis:p.colis??((xe=s==null?void 0:s.lot)==null?void 0:xe.TOT_COLIS)??0,poids:p.poids??((Ve=s==null?void 0:s.lot)==null?void 0:Ve.TOT_POIDS)??0,pieces:p.pieces??((we=s==null?void 0:s.lot)==null?void 0:we.TOT_PIECES)??0,UV:k,formats:t,handleChangeByName:R,labelColis:(Ue=s==null?void 0:s.lot)==null?void 0:Ue.TOT_COLIS,labelPoids:(He=s==null?void 0:s.lot)==null?void 0:He.TOT_POIDS,labelPieces:(We=s==null?void 0:s.lot)==null?void 0:We.TOT_PIECES}),e.jsxs(v,{className:"btns",children:[e.jsxs(v,{className:"actions",children:[e.jsxs(rt,{fullWidth:!0,exclusive:!0,onChange:(M,O)=>Y(O==="O"),value:s==null?void 0:s.ACH_LOT_ACTIF,children:[e.jsx(de,{color:"error",sx:{width:"100%","&.Mui-selected, &.Mui-selected:hover":{bgcolor:"red",color:"#fff"}},fullWidth:!0,value:"N","aria-label":"list",children:u("lotDisable")}),e.jsx(de,{color:"success",sx:{width:"100%","&.Mui-selected,  &.Mui-selected:hover":{bgcolor:"green",color:"#fff"}},fullWidth:!0,value:"O","aria-label":"module",children:u("lotEnable")})]}),e.jsx(B,{fullWidth:!0,startIcon:e.jsx(Nt,{}),size:"medium",onClick:A,variant:"outlined",color:"info",children:"Réguls"}),e.jsxs(B,{fullWidth:!0,startIcon:e.jsx(Se,{}),sx:{justifyContent:"flex-start"},size:"medium",onClick:G,variant:"outlined",color:"info",children:[e.jsx(b,{variant:"caption",color:"text.secondary",sx:{position:"absolute",left:0,right:0,bottom:0},children:"Picking Lot"}),s==null?void 0:s.LOT_PICKING]}),e.jsxs(B,{fullWidth:!0,startIcon:e.jsx(Ae,{}),sx:{justifyContent:"flex-start"},size:"medium",onClick:te,variant:"outlined",color:"info",children:[e.jsx(b,{variant:"caption",color:"text.secondary",sx:{position:"absolute",left:0,right:0,bottom:0},children:"DLC"}),e.jsx(b,{color:"warning.dark",variant:"inherit",children:((ze=s==null?void 0:s.lot)==null?void 0:ze.ACH_DLC)&&q((Ke=s==null?void 0:s.lot)==null?void 0:Ke.ACH_DLC)})]}),e.jsx(gt,{fullWidth:!0,size:"medium",onClick:M=>l(),variant:"outlined",color:"info",children:"Etiquettes"})]}),e.jsxs(v,{className:"validations",children:[e.jsx(B,{fullWidth:!0,startIcon:e.jsx(st,{}),size:"large",onClick:I,variant:"contained",color:"error"}),e.jsx(hn,{disabled:L,fullWidth:!0,size:"large",onClick:ge,variant:"contained",color:"success"})]})]})]})]})},zs=m.memo(Ws);function Ks({infoArticle:n,context:t,onSave:r,prepa:i,onClose:s,lotSelected:l}){const a=Ot(t,{nolot:l.STO_LOT},{enabled:!!l.STO_LOT}),o=he("STOCK"),h=_e(),d=(n==null?void 0:n.ART_UNIT_VEN)||"C",[f,u]=m.useState({colis:null,pieces:null,poids:null}),c=(x,T)=>{const p=x.target.name,g=+(x.target.value||0);u(S=>Re(S,L=>{var k,R;const{nbPiecesParColis:I,poidsMoyenColis:A,poidsMoyenPiece:_}=yt(null,((R=(k=a.data)==null?void 0:k.res)==null?void 0:R.result)||null);L[p]=g,T&&(p==="colis"&&(I&&(L.pieces=C.round((g??0)*I)),A&&(L.poids=C.round((g??0)*A,4))),p==="poids"&&(A&&(L.colis=C.round((g??0)/A,2)),_&&(L.pieces=C.round((g??0)/_,0))),p==="pieces"&&(I&&(L.colis=C.round((g??0)/I,0)),_&&(L.poids=C.round((g??0)*_,4))))}))};return a.error&&(h(":{"),s()),e.jsxs(e.Fragment,{children:[e.jsx(pn,{children:a.isLoading?e.jsx(Me,{}):e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"subtitle1",color:"text.disabled",children:" Commande"})," ",e.jsxs(b,{variant:"h4",children:[i.VEN_BL," - ",i.CLI_NOM]}),e.jsx($e,{}),e.jsx(b,{variant:"subtitle1",color:"text.disabled",children:" Lot"}),e.jsxs(b,{variant:"h5",children:[l.STO_LOT," ",l.FOU_NOM,"   "]}),e.jsxs(b,{variant:"h5",children:[" Date Réception:  ",l.ACH_DATE_REC&&q(l.ACH_DATE_REC)," "]}),l.ACH_DLC&&e.jsxs(b,{variant:"h5",children:[" DLC:  ",l.ACH_DLC&&q(l.ACH_DLC)," "]}),e.jsx($e,{}),e.jsx(jt,{sx:{alignItems:"stretch",color:"text.primary",bgcolor:"info.light",minHeight:120,borderRadius:1,border:1,p:1},colis:f.colis??i.TRA_COLIS_LIV,poids:f.poids??i.TRA_PDS_NET_LIV,pieces:f.pieces??i.TRA_QUANTITE_LIV,UV:d,labelColis:i.TRA_COLIS_LIV,labelPoids:i.TRA_PDS_NET_LIV,labelPieces:i.TRA_QUANTITE_LIV,formats:o,handleChangeByName:c})]})}),e.jsx(gn,{children:e.jsx(xt,{disabled:!!(a.isLoading||a.error),textCancel:"close",onSave:()=>r(f),onClose:s})})]})}const Qs={COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:120,md:{COLUMN_WIDTH:100,COLUMN_UNIT:"%",ROW_HEIGHT:60}},qs=({className:n,item:t,ItemComponentProps:r,onSelect:i,style:s,...l})=>{var h,d;const a=r.formatUvc,o=C.some(r.listSelected,f=>f.traSeq===t.TRA_SEQ);return e.jsxs(ft,{style:s,isSelected:o,onFirstAction:()=>r.addSelected(t),sx:{display:"grid",gridTemplateColumns:"8ch 1fr 13ch 120px 120px 120px ",gridTemplateAreas:' "cde client date stock1 stock2 stock3"    ',width:"100%",alignItems:"center",...ye},className:Q(n,"magenta"),onClick:f=>i(t),children:[e.jsx(J,{gridArea:"cde",label:"Bl",field:"VEN_BL",textAlign:"left",text:String(t.VEN_BL||""),matchSearch:(h=t._properties)==null?void 0:h.matchSearch,Icon:null,noBorder:!1}),e.jsx(J,{gridArea:"client",label:"Client",field:"CLI_NOM",textAlign:"left",text:t.CLI_NOM,matchSearch:(d=t._properties)==null?void 0:d.matchSearch,Icon:null,noBorder:!1}),e.jsx(J,{gridArea:"date",label:"Date BL",text:t.VEN_DATE_BL&&q(t.VEN_DATE_BL)||"",Icon:Ae,noBorder:!1}),e.jsx(E,{variant:"h5",fontSize:"inherit",format:a,UVC:"C",gridArea:"stock1",value:t.TRA_COLIS_LIV}),e.jsx(E,{variant:"h5",fontSize:"inherit",format:a,UVC:"N",gridArea:"stock2",value:t.TRA_PDS_NET_LIV}),e.jsx(E,{variant:"h5",fontSize:"inherit",format:a,UVC:"P",gridArea:"stock3",value:t.TRA_QUANTITE_LIV})]})};function Gs({formatUvc:n,listSelected:t,addSelected:r,context:i,state:s,onSelect:l}){const a=m.useMemo(()=>({listSelected:t,addSelected:r,formatUvc:n}),[n,t]),o=Ce();return e.jsx(Te,{state:s,onSelect:l,ItemMeasureCard:Qs,disablePadding:!0,disableGap:!0,disableContainer:!0,kbManageRef:o,ItemComponent:qs,ItemComponentProps:a,labelSearch:"",disableFavorite:!0})}function $s(n){const t=C.minBy(n);return Cn(t||Sn(new Date))}function et(n,t){var a;const r=C.isArray(t)?t:[t],i=C.reject(r,o=>!o.VEN_DATE_BL),s=$s(C.map(i,o=>xn(o.VEN_DATE_BL))),l=[le("ART_CODE",((a=n.article)==null?void 0:a.ART_CODE)||"","="),le("ACH_LOT_ACTIF","O","="),le("STO_LOT","0","<>"),le("ACH_DATE_REC",s,"<=")];return n.depot&&l.push(le("ACH_DEPOT",n.depot,"=")),{recherche:mn(l)}}function tt(n){return{traSeq:n.TRA_SEQ,colis:n.TRA_COLIS_LIV,pieces:n.TRA_QUANTITE_LIV,poids:n.TRA_PDS_NET_LIV,VEN_DATE_BL:n.VEN_DATE_BL,sens:"=",nolot:null}}function Zs({souche:n,infoArticle:t,onClose:r,onRefresh:i,className:s,context:l,operationId:a}){const o=he("STOCK"),h=Lt(l),d=De(a),f=ns(l,n,!!n),[u,c]=Kn({selected:[],recherche:null,modalFor:null,prepa:null}),x=m.useCallback(A=>{c(_=>Re(_,k=>{const R=k.selected,Y=R.findIndex(G=>G.traSeq===A.TRA_SEQ);Y!==-1?R.splice(Y,1):R.push(tt(A))}))},[]),T=A=>{A?u.modalFor==="LOT_SINGLE"?c(_=>({..._,modalFor:"SINGLE",lotSelected:A,recherche:null})):h.ModifieListTransaction.mutate({transactions:C.map(u.selected,_=>({traSeq:_.traSeq,sens:"=",colis:null,pieces:null,poids:null,nolot:A.STO_LOT}))},{onSettled(_,k,R,Y){var G;((G=_==null?void 0:_.res)==null?void 0:G.codeResult)==="OK"&&(i(),r())}}):c(_=>({..._,modalFor:null,recherche:null}))},p=A=>{const _={traSeq:u.prepa.TRA_SEQ,sens:"=",colis:A.colis,pieces:A.pieces,poids:A.poids,nolot:u.lotSelected.STO_LOT};h.ModifieListTransaction.mutate({transactions:[_]},{onSettled(k,R,Y,G){var $;(($=k==null?void 0:k.res)==null?void 0:$.codeResult)==="OK"&&(c(te=>({...te,prepa:null,modalFor:null,lotSelected:null})),i())}})},g=m.useCallback(A=>{n&&(C.isEmpty(u.selected)||c(_=>({..._,prepa:null,modalFor:"LOT_MULTI",...et(n,u.selected)})))},[n,u.selected]),S=A=>{n&&c(_=>({..._,modalFor:"LOT_SINGLE",prepa:A,...et(n,tt(A))}))},L=()=>c(A=>({...A,modalFor:null})),I=C.size(u.selected);return e.jsxs(Ze,{sx:{flexDirection:"column",justifyContent:"center",gap:1,p:.5},children:[e.jsx(Pe,{onCloseDialog:L,withAppBar:!0,i8ntitle:` Remplacement:  ${t==null?void 0:t.ART_CODE} -  ${t==null?void 0:t.ART_LIB1}`,isOpen:!!u.modalFor,dialogProps:{maxWidth:"lg",fullScreen:!1,fullWidth:!0},className:"",children:e.jsxs(Ze,{sx:{flexDirection:"column",justifyContent:"center",gap:1,p:.5},children:[e.jsxs(F,{container:!0,children:[u.modalFor==="LOT_SINGLE"&&!!u.prepa&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{item:!0,xs:12,md:5,children:[e.jsxs(b,{variant:"subtitle1",color:"text.disabled",children:[" Commande ",u.prepa.VEN_BL]}),e.jsxs(b,{variant:"h4",children:[" ",u.prepa.CLI_NOM]})]}),e.jsxs(F,{item:!0,xs:12,md:7,container:!0,flexDirection:"row",sx:{maxWidth:400,alignItems:"center",justifyContent:"center",color:I?"inherit":"text.disabled",bgcolor:"info.light",borderRadius:1,border:1},children:[e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"C",value:C.sumByNumber([u.prepa],"TRA_COLIS_LIV")}),e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"N",value:C.sumByNumber([u.prepa],"TRA_PDS_NET_LIV")}),e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"P",value:C.sumByNumber([u.prepa],"TRA_QUANTITE_LIV")})]})]}),u.modalFor==="LOT_MULTI"&&e.jsxs(F,{container:!0,item:!0,xs:12,md:5,flexDirection:"row",justifyContent:"space-around",sx:{maxWidth:400,justifyContent:"center",color:I?"inherit":"text.disabled",bgcolor:"info.light",borderRadius:1,border:1},children:[e.jsx(F,{item:!0,xs:4,children:e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"C",value:C.sumByNumber(u.selected,"colis")})}),e.jsx(F,{item:!0,xs:4,children:e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"N",value:C.sumByNumber(u.selected,"poids")})}),e.jsx(F,{item:!0,xs:4,children:e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"P",value:C.sumByNumber(u.selected,"pieces")})}),e.jsxs(b,{variant:"body1",children:[" ",I?I+" Ligne(s) sélectionnée(s)":"Aucune ligne sélectionnée"]})]})]}),(u.modalFor==="LOT_MULTI"||u.modalFor==="LOT_SINGLE")&&e.jsx(Fs,{context:d,recherche:u.recherche,onSelect:T}),u.modalFor==="SINGLE"&&e.jsx(Ks,{context:d,onSave:p,infoArticle:t,onClose:L,lotSelected:u.lotSelected,prepa:u.prepa})]})}),e.jsxs(v,{display:"flex",gap:1,children:[e.jsx(B,{size:"large",variant:"contained",onClick:A=>{c(_=>({..._,selected:[]}))},children:"RAZ"}),e.jsx(B,{size:"large",disabled:C.isEmpty(u.selected),variant:"contained",onClick:g,children:"LOT"}),e.jsxs(be,{display:"flex",flex:1,sx:{maxWidth:450,color:I?"inherit":"text.disabled",bgcolor:"info.light",borderRadius:1,border:1},children:[e.jsxs(F,{container:!0,flexDirection:"row",justifyContent:"space-around",children:[e.jsx(F,{item:!0,xs:4,children:e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"C",value:C.sumByNumber(u.selected,"colis")})})," ",e.jsx(F,{item:!0,xs:4,children:e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"N",value:C.sumByNumber(u.selected,"poids")})}),e.jsx(F,{item:!0,xs:4,children:e.jsx(E,{variant:"h4",fontSize:"medium",format:o,UVC:"P",value:C.sumByNumber(u.selected,"pieces")})})]}),e.jsxs(b,{variant:"body1",children:[" ",I?I+" Ligne(s) sélectionnée(s)":"Aucune ligne sélectionnée"]})]})]}),e.jsx(Gs,{formatUvc:o,listSelected:u.selected,addSelected:x,context:l,state:f,onSelect:S})]})}function Js({onClose:n,onPrint:t}){const[r,i]=Tn("imprimanteEtiquettePreparation","",!1,"SCALAR"),[s,l]=m.useState(()=>({nbExEtiquette:1})),a=(h,d)=>{l(f=>({...f,[h]:d}))},o=()=>{t({imprimante:r,nbExemplaire:s.nbExEtiquette})};return e.jsxs(v,{display:"flex",flexDirection:"column",gap:1,sx:{p:1,pt:3},children:[e.jsx(F,{container:!0,justifyContent:"center",children:e.jsx(F,{item:!0,xs:12,md:4,children:e.jsx(zn,{nbEx:s.nbExEtiquette||0,color:"warning",typeImprimante:_n.ETIQ,imprimante:r,imprimanteDefaut:null,onChangeNbEx:h=>a("nbExEtiquette",In(h,s.nbExEtiquette)),title:ue("labelPrinter"),label:ue("copy"),onChangePrinter:function(h){i(h)}})})}),e.jsx(xt,{ButtonValidate:h=>e.jsx(gt,{...h,color:"success",children:ue("print")}),onSave:o,onClose:n})]})}function Ys({operationId:n,lotStock:t,onCloseModal:r,context:i,onRefresh:s,infoArt:l}){const a=vt(n),o=ps(n),h=pe(i);return e.jsxs(Pe,{dialogProps:{maxWidth:"lg",fullScreen:!1,fullWidth:!0},i8ntitle:a==="SOUCHE"?"Lot "+((o==null?void 0:o.nolot)||0):"Etiquettes",onCloseDialog:r,"aria-labelledby":"customized-dialog-title",isOpen:!!a,withAppBar:!0,className:"",children:[a==="SOUCHE"&&e.jsx(Zs,{infoArticle:(l==null?void 0:l.article)||null,onRefresh:s,className:"modalFullWidth",context:i,operationId:n,onClose:r,souche:o}),a==="PRINT"&&e.jsx(Js,{onClose:r,onPrint:({imprimante:d,nbExemplaire:f})=>{t&&h.mutations.EditionInventaireFidege.mutate({imprimante:d,nbExemplaire:f,numeroLot:t},{onSettled(u,c,x,T){r()}})}})]})}const Xs=({className:n,formats:t,onOpenSouche:r,onOpenPicking:i,article:s})=>{var l,a,o,h,d,f,u;return e.jsxs(v,{className:"infoArticle",children:[e.jsxs(v,{sx:ye,className:Q("article",n),children:[e.jsx(B,{variant:"contained",color:"secondary",onClick:i,startIcon:e.jsx(Se,{}),children:((l=s==null?void 0:s.article)==null?void 0:l.ART_PICKING)||""}),e.jsxs(be,{flexDirection:"column",alignItems:"flex-start",children:[e.jsxs(be,{flexDirection:"row",alignItems:"center",gap:.5,children:[e.jsx(it,{fontSize:"small",codeStat:(a=s==null?void 0:s.article)==null?void 0:a.ART_STAT_IMAGE}),e.jsx(b,{variant:"h6",children:(o=s==null?void 0:s.article)==null?void 0:o.ART_LIB1}),!!((h=s==null?void 0:s.article)!=null&&h.ART_PAYS)&&((d=s==null?void 0:s.article)==null?void 0:d.ART_PAYS)!=="0"&&e.jsx(at,{svg:!0,countryCode:(f=s==null?void 0:s.article)==null?void 0:f.ART_PAYS})]}),e.jsx(b,{variant:"inherit",children:(u=s==null?void 0:s.article)==null?void 0:u.ART_CODE})]})]}),e.jsxs(v,{className:"qte",children:[e.jsx(E,{showNull:!0,fontSize:"medium",format:t,UVC:"C",value:(s==null?void 0:s.colis)||null}),e.jsx(E,{showNull:!0,fontSize:"medium",format:t,UVC:"N",value:(s==null?void 0:s.poids)||null}),e.jsx(E,{showNull:!0,fontSize:"medium",format:t,UVC:"P",value:(s==null?void 0:s.pieces)||null})]}),e.jsx(v,{className:"btns",children:e.jsx(B,{fullWidth:!0,sx:{height:"100%"},variant:((s==null?void 0:s.nbCommandes)||0)>0?"contained":"text",color:"warning",onClick:r,children:e.jsx(Ln,{badgeContent:s==null?void 0:s.nbCommandes,children:"Lot 0"})})})]})},er=m.memo(Xs),tr=({operationId:n})=>{var $,te,ge,ne,se,re,ie,ae;const t=De(n),r=m.useContext(Rt),{t:i}=fe(),s=he("STOCK"),l=ke(),a=pe(t),o=fs(n),h=ls(n),d=cs(n),f=us(n),u=ds(n),c=vt(n),x=ts(t,r.scan.onLectureCodeBarreDepuisArticle,h||null,f,null,!0),T=bs(t,{codart:h},{enabled:!!h}),p=((te=($=T.data)==null?void 0:$.res)==null?void 0:te.result)||null,g=d||((ne=vn(((ge=x.data)==null?void 0:ge.list)||null))==null?void 0:ne.STO_LOT)||null,S=Ot(t,{nolot:g},{enabled:!!g}),L=An("md"),I=m.useCallback((z=!0)=>{S.refetch(),x.data.refetch(),T.refetch(),z&&r.onClearLotSelected({})},[]),A=m.useCallback(()=>{I(!0)},[]),_=m.useCallback(async()=>{r.onOpenSouche({souche:{article:(p==null?void 0:p.article)||null,depot:null,nolot:0}})},[h,p==null?void 0:p.article]),k=m.useCallback(z=>{h&&a.handleOpenPicking(h,Z=>{l.updateInfoArt({codart:h},xe=>({article:{...xe.article,ART_PICKING:Z.codPicking}}))})},[h]),R=m.useCallback(z=>{z.STO_LOT&&r.onSelectLot({nolot:z.STO_LOT})},[]),Y=m.useMemo(()=>({lotSelected:g,onOpenLotSouche:Z=>{Z.STO_LOT&&r.onOpenSouche({souche:{article:(p==null?void 0:p.article)||null,depot:null,nolot:Z.STO_LOT}})}}),[g,p==null?void 0:p.article]),G=Ce(!c);return T.error?e.jsx(Je,{errorTitle:bn(T.error),onSecondAction:r.onStepBack}):e.jsx(v,{className:Q("stockArticle"),children:T.isInitialLoading?e.jsx(Me,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ys,{operationId:n,context:t,onCloseModal:r.onCloseModal,lotStock:g,onRefresh:I,infoArt:p}),(u===0||L)&&e.jsxs(e.Fragment,{children:[e.jsx(er,{className:bt(((re=(se=T.data)==null?void 0:se.res)==null?void 0:re.result.statut)||null),onOpenSouche:_,onOpenPicking:k,article:p,formats:s}),S.error?e.jsx(Je,{errorTitle:"Lot non trouvé.",onSecondAction:r.onClearLotSelected,secondActionMessage:i("close")}):e.jsx(zs,{context:t,formats:s,article:p,lot:((ae=(ie=S.data)==null?void 0:ie.res)==null?void 0:ae.result)||null,lotStock:g,isFetching:S.isInitialLoading,isReFetching:S.isRefetching,natureInventaire:o,onSelectNatureInventaire:r.onSelectNatureInventaire,onSaveComplete:A,onOpenPrint:r.onOpenPrint})]}),(u===1||L)&&e.jsx(Te,{className:"listLot",state:x,onSelect:R,disablePadding:!0,disableGap:!0,disableContainer:!0,kbManageRef:G,ItemComponentProps:Y,ItemComponent:Ps,labelSearch:"",gridModes:["list"],ItemMeasureCard:ys}),e.jsx(On,{className:"bottomNavigationContainer",elevation:2,children:e.jsxs(En,{showLabels:!0,value:u,onChange:(z,Z)=>{r.onChangeBottomState(Z)},children:[e.jsx(Ye,{label:"Edition",icon:e.jsx(jn,{}),value:0}),e.jsx(Ye,{label:"Lots",icon:e.jsx(qn,{}),value:1})]})})]})})},nr=Nn(Qn)(({theme:n})=>`
 
   
    .stockArticle{
      padding:0.5rem;
      display:flex;
      flex-direction: column;
      height:100%;
      gap:0.5rem;
      color: ${n.palette.text.primary};
      font-size:${n.typography.h6.fontSize};
      font-familly:${n.typography.h6.fontFamily};
      font-weight:${n.typography.h6.fontWeight};

      & .bottomNavigationContainer{
        justify-self: flex-end;
        z-index: ${n.zIndex.appBar};
        background: ${n.palette.background.paper};
        
        padding:0.5rem;
        display:none;
        
        margin-top: 0.5rem;
        & .MuiButtonBase-root.MuiBottomNavigationAction-root.Mui-selected{
          color: ${n.palette.secondary.dark};
        }
      
      }
      & .scrollArea{
        flex-basis:100%;
        
      }
      & .infoLot{
        
          position: relative;
          background-color:  #9e8abe2b; 
          box-shadow: ${n.shadows[2]};
          flex: 0; 
          flex-shrink:0;
  
          & > .header-container{
            min-height: 160px;
            display: grid;
            margin: 0;
            gap: 0;
            padding: ${n.spacing(.5)};
            grid-template-columns: minmax(50%,1fr) 1fr;
            grid-template-areas:  "lot qtys"
                                    "frn qtys"
                                    "dlc qtys"
                                    "traca qtys"
                                    "btns btns";
            &.disabled{
              opacity:0;
            }

            & > .btns{
                  grid-area: btns;
                  display: flex;
                  & .actions{
                      flex:1;
                      display: grid;
                      gap: 4px;
                      grid-template-columns: repeat( auto-fit, minmax(120px, 1fr)  ); 
                      justify-content: space-around;

                      & > .MuiButton-outlined, > .MuiButton-outlined:hover{
                        background-color: ${n.palette.background.paper};
                      }

                  }
                   & .validations{
                      display:flex;
                      gap: 0.5rem;
                      & > *{
                        min-width: 150px;
                      }
                  }
                  
                  
                  
                }
          }
 
         

        
       
      }

      & .infoArticle{
        box-shadow: ${n.shadows[2]};
        gap:0.5rem;
        display:grid;
        justify-content: stretch;
        
        grid-template-columns: 1fr minmax(200px,min-content) min-content;
        grid-template-areas: "article qte btns" ;

        & .article{
         
          display: flex;
          gap: 0.5rem;
          grid-area: article;

        }
       
        & .qte{
          justify-content: space-around;
          display: flex;
          gap: 0.5rem;
          grid-area: qte;
          background: ${n.palette.background.paper};
          border:1px solid ${n.palette.divider};
         
        }
      }
       
    }

  
   

    .line-article-stock{
        display: grid;
        gap: 5px;
     
        height: 100%;
        padding: 0;
        width: 100%;
    
        align-items: stretch;
        grid-template-columns:  minmax(0, 1fr) 4ch 11ch 140px 140px auto;
        grid-template-areas: "art nblot dlcMini qtephy qte arrivage";
        & > *{
          overflow: hidden;
        }
       
      }

      .line-lot-stock{
        column-gap: 0.5rem;
        padding: 0;
        width:  100%;
         height: 100% ;
        display: grid ;
        align-items:  center ;
        overflow:  hidden ;
        grid-template-columns:  10ch 1fr 13ch 120px 120px 120px;
        grid-template-areas:   "nolot frn dlc stock1 stock2 stock3"
        "arrivage arrivage dlc stock1 stock2 stock3" ;
       
        &.lotSelected{
          border-left: 8px solid ${n.palette.secondary.dark};
        }
      
      }

    
      ${n.breakpoints.down("md")}
      {
        .stockArticle{
          gap:1px;
          & .infoArticle{ 
            gap:1px;
            grid-template-columns: 1fr 6rem;
            grid-template-areas: "article  btns"
            "qte  btns";

          }


          & .infoLot {
            flex:1;
            overflow:auto;
            & .header-container{
                  grid-template-areas: "lot lot"
                  "frn frn"
                  "dlc dlc"
                  "traca traca" 
                  "qtys qtys"
                  "btns btns";

                 & .btns{
                      display: block;

                }

          }

     
        
          & .bottomNavigationContainer{
            display:block;
          }

         
          
        }

       

        & .accueil{
          grid-template-rows: min-content minmax(0,1fr) min-content min-content;
          grid-template-areas: "personnel zoneTravail" 
            "filtresQuick filtresQuick"
            "navigate navigate"
            "scanContainer scanContainer" 
             ;
           
        }
        .line-lot-stock{ 
          grid-template-columns:  1fr 1fr 1fr;
          grid-template-areas:
              "nolot frn dlc"
              "stock1 stock2 stock3"
              "arrivage arrivage arrivage" ;      
        }

        .line-article-stock{
          padding-bottom:10px;
          gap:0 ;
          grid-template-columns:  1fr 1fr 1fr;
          grid-template-areas:
              "art art art"
              "art art art"
              "nblot qte qtephy" 
              "nblot qte qtephy";
          & > *{
              border:none;
          }
          & .arrivage{
              display:none;
          }
          & .dlcMini span   {
              display:none;
          }
          & .dlcMini    {
            position : absolute; 
            bottom:0;
            left:0;
            right:0;
            flex-direction: row;
            & .MuiTypography-root{
              font-size: 0.85rem;
              color: ${n.palette.text.secondary};
            }
        }
      }
 
      }



`),Rt=m.createContext(null);function Mt({operationId:n}){const{disableSwitchPersonnel:t,data:r,contextGlobal:i,codePersonnel:s,nomPersonnel:l,operation:a,actions:o}=hs(n);return e.jsx(Rt.Provider,{value:o,children:e.jsxs(nr,{className:"inventaireFidege",children:[e.jsx(ms,{onChangeStep:o.onChangeStep,onStepBack:o.onStepBack,step:a.step,operationId:n}),e.jsx(Pe,{dialogProps:{transitionDuration:0,disableEnforceFocus:!0,disableRestoreFocus:!0,maxWidth:"md",fullWidth:!0,fullScreen:!1},withAppBar:!0,isOpen:!!a.modalFor,onCloseDialog:()=>o.onCloseModal(),i8ntitle:null,className:"",children:a.modalFor==="SCAN"&&e.jsx(e.Fragment,{children:e.jsx(Ss,{})})}),a.step===K.HOME&&e.jsx(Cs,{className:"accueil",disableSwitchPersonnel:t,codePersonnel:s,nomPersonnel:l,zoneTravailPersonnelCode:a.zoneTravailPersonnelCode,zoneTravailPersonnelLibelle:a.zoneTravailPersonnelLibelle,onNavigateList:o.onNavigateList,onChangeZoneTravail:o.onChangeZoneTravail,onChangePersonnel:o.onChangePersonnel,data:r,contextGlobal:i,onOpenModalSearchOrder:o.scan.onOpenModalSearchOrder,onScanSuccess:o.scan.onScanSuccess,onLectureCodeBarre:o.scan.onLectureCodeBarre,onScanError:o.scan.onScanError}),a.step===K.LIST&&e.jsx(As,{state:r,onSelect:o.onSelectArticle,context:i}),a.step===K.STOCKARTICLE&&e.jsx(tr,{operationId:n})]})})}function sr({session:n,borneId:t}){const r=n.sessionId,i=Yn(r,t);return i?e.jsx(e.Fragment,{children:e.jsx(Mt,{operationId:i})}):null}function rr(){const{operationId:n}=mt(),t=Mn();return e.jsx(Pn,{fallbackRender:r=>e.jsx(e.Fragment,{children:e.jsx(kn,{errorOrigin:"Router",...r,resetMessage:"back"})}),onReset:()=>{t("/")},children:e.jsx(Mt,{operationId:n})})}function xr(){const{session:n,onLaunchOption:t}=yn(),{borneId:r}=mt();return e.jsxs(Rn,{children:[e.jsx(Xe,{index:!0,element:e.jsx(sr,{session:n,borneId:r})}),e.jsx(Xe,{path:":operationId",element:e.jsx(rr,{})})]})}export{xr as default};

import{bL as j,as as f,w as b,x as S,j as e,r as d,G as c,aD as B,I as N,aj as M,bR as A,cz as R,gY as _,aq as k,an as w,ar as D,ao as h,bN as E,C as F,bG as L,aT as G,aS as U,gZ as q}from"./index-2ba9b923.js";import{a as O}from"./index-2c2ee258.js";function z(t=null){return j({key:"ImagesBorne",fxt:{retrieve:(l,r)=>f().ImagesMethods().rechercheImagesBornes(l,null,(r==null?void 0:r.current)||null)},query:t})}var p={},H=S;Object.defineProperty(p,"__esModule",{value:!0});var I=p.default=void 0,T=H(b()),P=e,Q=(0,T.default)((0,P.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"}),"Photo");I=p.default=Q;const C=({handleSaveComplete:t,handleClose:l})=>{const r=d.useRef(!1),a=d.useRef(null),[n,u]=d.useState({type:"",file:null,fileUrl:null}),g=s=>{if(s.preventDefault(),!r.current){if(!n.file)return!1;r.current=!0,f().ImagesMethods().insertImage({variables:{file:n.file,fileName:n.fileName}}).then(({err:i,res:x})=>{r.current=!1,i?alert(typeof i=="object"?JSON.stringify(i):i):(_(),t())})}},m=s=>{k.isEmpty(s.target.files)||u(i=>({file:s.target.files[0],fileName:i.fileName||s.target.files[0].name,type:"UPLOAD",fileUrl:URL.createObjectURL(s.target.files[0])}))};return e.jsxs(c,{m:1,children:[e.jsxs(c,{onClick:s=>a.current.click(),sx:{my:1,boxShadow:2,cursor:"pointer",".preview":{width:"60px",height:"60px",boxSizing:"content-box",display:"block",margin:"auto",padding:"1rem"}},children:[e.jsx("input",{ref:a,type:"file",name:"image",style:{display:"none"},onChange:m}),e.jsx("img",{src:n.fileUrl||"",alt:"télécharger",className:" preview"})]}),e.jsxs(c,{display:"flex",gap:.3,children:[e.jsx(B,{fullWidth:!0,name:"title",value:n.fileName,label:"name",onChange:s=>u(i=>({...i,fileName:s.target.value}))}),e.jsx(N,{size:"medium",onClick:s=>a.current.click(),children:e.jsx(I,{})})]}),e.jsx(M,{}),e.jsxs(c,{display:"flex",gap:1,children:[e.jsx(A,{variant:"outlined",onClick:g}),e.jsx(R,{variant:"outlined",onClick:s=>{l()}})]})]})};C.displayName="EditImage";function V({item:t,className:l="",isLoading:r,maxWidth:a,onAddFavorite:n,favorites:u,editFavorite:g,onSelect:m,...s}){const i=w().current,x=D({mutationFn:o=>f().ImagesMethods().supprimeImageBorne(i,o)}),v=h(),y=o=>{x.mutate(o,{onSuccess:Y=>{v.invalidateQueries({queryKey:["ImagesBorne"]})}})};return t?e.jsxs(c,{sx:o=>({display:"flex",width:a,maxWidth:a,...o.typography.body1,height:"100%",margin:0,overflow:"hidden",flexGrow:1,gap:.4,borderBottom:1,borderBottomColor:"divider"}),style:{maxWidth:a},children:[e.jsxs(E,{onClick:o=>m(t),sx:{p:1,flexGrow:1,display:"flex"},children:[e.jsx(c,{children:e.jsx(O,{img:f().ImagesMethods().getImageBorne(t.NAME)})}),e.jsx(c,{sx:{flexGrow:1},children:e.jsx(F,{color:"primary",variant:"h5",children:t.NAME})})]}),e.jsx(L,{color:"error",variant:"text","aria-label":"Delete",onClick:o=>y(t.IMG_SEQ),size:"large"})]}):null}const K={primaryField:"IMG_SEQ",secondaryField:"NAME"},J={COLUMN_WIDTH:25,COLUMN_UNIT:"%",ROW_HEIGHT:60},W=t=>{const l=h(),[r,a]=d.useState(!1),n=d.useCallback(()=>a(!1),[a]);return e.jsxs(e.Fragment,{children:[e.jsx(U,{withAppBar:!1,isOpen:r,onCloseDialog:n,className:"",children:e.jsx(C,{handleSaveComplete:u=>{l.invalidateQueries({queryKey:["ImagesBorne"]}),n()},handleClose:n})}),e.jsx(q,{position:"fixed",sx:{top:24,right:4},onClick:u=>{a(!0)}})]})};function $({recherche:t,onSelect:l,...r}){const a=z(t);return e.jsx(G,{labelSearch:"",placeholderSearch:"",onSelect:l,HeaderComponent:null,...r,state:a,ItemComponent:V,ItemMeasureCard:J,ItemComponentProps:K,ActionsButtons:W})}export{$ as default};
